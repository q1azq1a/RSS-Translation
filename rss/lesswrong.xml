<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title><![CDATA[LessWrong]]></title><description><![CDATA[A community blog devoted to refining the art of rationality]]></description><link/> https://www.lesswrong.com<image/><url> https://res.cloudinary.com/lesswrong-2-0/image/upload/v1497915096/favicon_lncumn.ico</url><title>少错</title><link/>https://www.lesswrong.com<generator>节点的 RSS</generator><lastbuilddate> 2023 年 9 月 13 日星期三 06:16:03 GMT </lastbuilddate><atom:link href="https://www.lesswrong.com/feed.xml?view=rss&amp;karmaThreshold=2" rel="self" type="application/rss+xml"></atom:link><item><title><![CDATA[The Flow-Through Fallacy]]></title><description><![CDATA[Published on September 13, 2023 4:28 AM GMT<br/><br/><p>存在某种非正式的推理谬误，即您提倡的某些事情似乎是我们“一定要做”的事情，看起来显然很重要，但我们没有考虑到所涉及的所有步骤，因此我们实际上并没有这样做有理由假设影响会流过。</p><p>这里有些例子：</p><ul><li>计算机科学系主任认为“当然，重要的是不仅要培养技术精湛的毕业生，而且要培养那些将技能用于行善的人”。因此他们要求所有学生必须上“技术和道德课”。唯一的问题是，他们的教授都不是这方面的专家，甚至对此都不感兴趣，所以它最终成为一门教学和管理都很差的学科，基本上让学生对这个话题感到厌烦。</li><li>一个国家的总理希望减少犯罪，因此他大幅增加了对警察部门的资金，但他们如此腐败和裙带关系，以至于该部门无法有效地使用这些资金。</li><li>政府想要加大回收力度，所以设立了“全国回收日”，但大多数人最终都忽视了这一点，而那些真正热心的人，大多数都付出了几天甚至一周的额外努力来回收，然后在今年剩下的时间里基本上就忘记了它。</li></ul><p>在上述每种情况下，如果决策者花时间仔细考虑并询问自己是否可能真正获得好处，他们可能不会选择相同的选项。</p><p>领域经验有助于了解此类问题可能会突然出现，但<a href="https://www.lesswrong.com/tag/murphyjitsu">墨菲术</a>（Murphyjitsu）计划的习惯也是如此。</p><p>需要明确的是，我无意提及以下可能出错的方式：</p><ul><li>副作用：政府引入蛇是为了减少啮齿动物的数量，但这会产生副作用，导致更多的人被蛇咬伤。</li><li>反应：艾米向民主党捐赠 1000 万美元。鲍勃听说此事后决定向共和党捐赠 2000 万美元作为回应</li><li>价值混乱：詹姆斯小时候花了数年时间收集他的口袋妖怪卡牌，但他认为一旦他成年，这就没有意义了。</li></ul><p> （如果这个谬论已经有了名字，或者你认为你已经想到了一个更好的名字，请告诉我。）</p><br/><br/><a href="https://www.lesswrong.com/posts/G9GmrYhQm6bKt2XJJ/the-flow-through-fallacy#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/G9GmrYhQm6bKt2XJJ/the-flow-through-fallacy<guid ispermalink="false"> G9GmrYhQm6bKt2XJJ</guid><dc:creator><![CDATA[Chris_Leong]]></dc:creator><pubDate> Wed, 13 Sep 2023 04:28:29 GMT</pubDate> </item><item><title><![CDATA[Book review: The Importance of What We Care About (Harry G. Frankfurt)]]></title><description><![CDATA[Published on September 13, 2023 4:17 AM GMT<br/><br/><p>实际上，这更多的是总结或释义，而不是评论。 <i>《我们关心的事情的重要性》</i>是哲学家哈里·G·法兰克福的 13 篇文章。这些是我对每一项的一段总结：</p><ol><li>如果你做某事是因为你愿意自己这样做，那么你就必须对这件事负责，即使你实际上不能这样做。如果您采取该行动的实际原因是您有意这样做，那么您的行为是在胁迫威胁下进行的或者是预先确定的这一事实并不能免除您的责任。要让你因某些行为而受到指责/值得赞扬，并不需要你可能做了其他事情，这与几个世纪以来关于道德的理论相反。</li><li> “人”的一个也许定义性的属性是，我们可以形成“二阶意志”：关于我们的欲望的欲望。因为一个人可能希望她的意志指向除当前愿望之外的其他愿望，所以对于<i>人</i>来说，就会出现“自由意志”的问题：我是否有能力选择自己的愿望，或者我只是有能力选择自己的愿望？努力实现目前占主导地位的任何未选择的愿望？</li><li>威胁和提议是一个人试图影响某人以某种特定方式行使他的意志的两种方式。对于其中任何一个，要上升到“强制”的水平，或者至少是“强制”的水平——从某种意义上说，免除被强制的人对由此产生的行为的道德责任——它必须超越仅仅<i>影响</i>他的意志，而变得更加重要。就像把自己的意志强加给他一样。</li><li>做某事是因为它是可得之害中较小的一个，因此人们宁愿不做某事，但仍然是自由和负责任地做它。尽管对较小的恶行<i>负责</i>并不一定意味着你应该为这些恶行<i>承担责任</i>。如果确实是两害相权取其轻，那就足以转移责任。</li><li>我们所做的事情可能是主动的（行动）或被动的（仅仅是发生的事情）。 “激情”（例如愤怒）也可以是主动的或被动的：有些激情是我们自身的一部分（它们是“内在的”），另一些则在未经我们同意的情况下控制了我们（“外部的”）。一个人可以通过拒绝它或拒绝与它合作，甚至通过不情愿地屈服来将一种激情外化，或者可以通过同意它、顺从它、将它融入到一个人的自我形象中来内化一种激情。仅仅对你实际上自愿参与的热情感到<i>遗憾</i>并不足以将其具体化。</li><li>某人所做的事是他们的“行动”还是“仅仅是发生的事情”，不能通过查看该活动的史前历史来找出其因果关系（例如，它是有意的还是期望的）来解决。相反，活动（或进行活动的人）发生时的某些情况会区分情况：活动是否是<i>在该人的指导下</i>进行的。一种不被期望、不愿意或什至预期的行为，如果在发生时该人拥有它并有意识地引导它，那么它仍然可以是一个人的行为。</li><li>与认识论和伦理学并行的是“关心什么”的研究。关心某件事就是对它进行长期的个人投资。关心不一定甚至常常是自愿的，但塑造一个人关心的事物是塑造一个人意志的重要方式。关心某事就是赋予它意志力：激发“意志上的必然性”。一个被意志必然性所强迫的人通常不会觉得她的意志被克服了，但这种强迫就是（或与）她的意志相容的。被我们关心的事情（例如真相）所强迫是矛盾的解放。哪些事物值得关心的问题很容易受到哲学批判。如果你要关心任何事情，那么关心你是否关心正确的事情是一个很好的起点。</li><li>我在文章＃1中表明，替代可能性原则是错误的，该原则认为，只有当一个人本可以采取其他行动时，他才可以对他的行为承担道德责任。我还断言，决定论是否正确以及如果正确是否与自由意志相容的难题对于道德责任问题并不重要。 Peter van Inwagen 相信他已经证明我的观点是错误的。他错了。</li><li>人们以一种不精确的方式使用“需要”这个词，这可能会让需要看起来很重要，即使它们并不重要。 “需要”不是绝对的，而是始终与目的相关：我需要α<i>才能</i>β。要了解 α 的道德优先性，您必须检查 β； α的道德优先性源自β的道德优先性。特别是，仅仅因为你自愿承担的愿望而产生的需求是不值得尊重的。</li><li>什么是“胡说八道”？从本质上讲，这是对真相的漠视：一种虚张声势，人们只是装腔作势地传达一些事实，却没有真正关注如何表达真相。它与“谎言”的部分不同之处在于，说谎者确实关心事实是什么（以便歪曲事实）。也正因为如此，追求真理的事业才更加危险。由于各种原因，它最近也显得尤为突出。</li><li>经济平等是社会理想的不明智选择。 “最大限度地提高充足率”是一个更好的选择。关注一个人的相对经济地位而不是一个人的绝对经济需求在道德上是令人迷失方向的。一些关于经济平等价值的常见经济论点经不起仔细检验。甚至罗尔斯式的不平等的限定理由（“差异原则”）也太不温不火了。</li><li>意识的体验同时也是自我意识的体验，或者是反思性意识的体验。 （这似乎也是多余的，“本体论上的荒谬”）。我们特别关心我们的动机意识。我们通常（除非我们“肆意”）将我们当前的动机与我们认为理想的动机进行比较。通过决定支持某一特定动机，一个人就“构成了他自己”；通过实现这一目标，他运用了“自己的意志”。如果一个人继续受到与自己决定认同的人相反的动机的影响，那么一个人可能无法做到“全心全意”。</li><li>因为对于功利主义者来说，福祉是唯一理性的善，因此从理论上讲，没有任何一种行动对他们来说是禁止的（在某些可以想象的情况下，任何一种行动都可能改善福祉）。因此，他们似乎很难对某些行为原则做出持久的承诺（除了功利主义本身）。同样的怀疑也针对无神论者（如果没有神，一切都是允许的）。然而，一个人可能确实仍然认为某些行动方针是“不可想象的”，基于她本性中不可或缺的某些东西，并且不会采取这样的行动。这可能是一件理性的事情，并且确实可以将我们从令人反感的判断结论中拯救出来。</li></ol><br/><br/> <a href="https://www.lesswrong.com/posts/e2fDabrdgrLDzA47q/book-review-the-importance-of-what-we-care-about-harry-g#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/e2fDabrdgrLDzA47q/book-review-the-importance-of-what-we-care-about-harry-g<guid ispermalink="false"> e2fDabrdgrLDzA47q</guid><dc:creator><![CDATA[David Gross]]></dc:creator><pubDate> Wed, 13 Sep 2023 04:17:16 GMT</pubDate> </item><item><title><![CDATA[Padding the Corner]]></title><description><![CDATA[Published on September 13, 2023 1:30 AM GMT<br/><br/><p><span>我爸爸的厨房里有一个架子，离地大约四英尺。我记得当我不再矮到可以在它下面行走时：哎呀！我没有受到脑震荡或其他什么影响，但这非常不愉快。我的姐妹和表兄弟姐妹也记得他们对此摇头不已。我注意到我的大女儿已经够高了，于是开始给她讲这个故事，警告她注意这一点。</span></p><p>当我讲故事的时候，我意识到这是多么愚蠢，于是停下手头的事情，在角落里放了一些垫子。</p><p> <a href="https://www.jefftk.com/washcloth-padded-corner-big.jpg"><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/dNBeQdB35qKruoCpr/yccwa82xz4pbcwhkz40p" srcset="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/dNBeQdB35qKruoCpr/yccwa82xz4pbcwhkz40p 550w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/dNBeQdB35qKruoCpr/m5ojftrweqlvxxt4rzro 1100w"></a></p><div></div><p></p><p>折叠起来并用螺钉固定在架子上的毛巾看起来不太好，但几年后的今天，三个表兄弟都足够高，可以与它相交，而且没有人受伤。也许有一天我们可以做一些更优雅的事情，但与此同时，修复尖角胜过警告人们。</p><p><i>评论通过： <a href="https://www.facebook.com/jefftk/posts/pfbid034oVcWajuvk8MWeyna2ybS8iEqC28DEqRq42T32f3LGpe9uH2crmAL4aVxkFHDL2bl">facebook</a> , <a href="https://mastodon.mit.edu/@jefftk/111055243593039436">mastodon</a></i></p><br/><br/><a href="https://www.lesswrong.com/posts/dNBeQdB35qKruoCpr/padding-the-corner#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/dNBeQdB35qKruoCpr/padding-the-corner<guid ispermalink="false"> dnBeQdB35qKruoCpr</guid><dc:creator><![CDATA[jefftk]]></dc:creator><pubDate> Wed, 13 Sep 2023 01:30:04 GMT</pubDate> </item><item><title><![CDATA[Should an undergrad avoid a capabilities project?]]></title><description><![CDATA[Published on September 12, 2023 11:16 PM GMT<br/><br/><p><i>虽然我写的是我的个人情况和项目，但我希望其他人也能遇到这种情况。</i></p><p>我正在考虑加入<strong>ProjectX。</strong>这听起来像是一个与人工智能合作、获得经验并有可能创造出令我自豪的东西的绝佳机会。不幸的是，它是关于提高人工智能效率，我将其理解为“能力”。当能力增强时，世界末日就会越来越近、可能性也越来越大。</p><p></p><p>有关该项目的更多信息：</p><p> <strong>“ProjectX：机器学习研究竞赛</strong></p><p>ProjectX 是<strong>世界上最大的本科机器学习研究竞赛，</strong>参赛团队来自世界各地的顶尖大学。 3支获胜团队将分别获得<strong>20,000加元</strong>的现金奖励，所有参赛者将被邀请参加2024年1月中旬<strong>举行的多伦多大学人工智能年会</strong>。去年的比赛由谷歌、英特尔和Nvidia赞助，并有特邀主讲人詹姆斯·范龙.</p><p>今年的重点是<strong>高效人工智能</strong>：研究创新方法和机器学习方法来创建人工智能模型，在不影响性能的情况下显着降低功耗。</p><p><br></p><p>今年我们将派出一支由 3-6 名学生组成的团队代表西北大学。该团队将在 2023 年 10 月至 12 月期间研究他们选择的问题，最终发表一篇描述他们的发现的论文。</p><p><a href="https://drive.google.com/file/d/1_v4vlZlgY6KgCXXPF_m76dBZnTkDpEX5/view?usp=sharing">有关今年比赛的更多信息</a></p><p><a href="https://drive.google.com/file/d/1UotPB5_4_9akc8mcPFQYQCWwdD7YLJed/view?usp=sharing">去年获奖团队的论文样本</a>“</p><br/><br/> <a href="https://www.lesswrong.com/posts/az2ibmLhv3enpfrdq/should-an-undergrad-avoid-a-capabilities-project#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/az2ibmLhv3enpfrdq/should-an-undergrad-avoid-a-capability-project<guid ispermalink="false"> az2ibmLhv3enpfrdq</guid><dc:creator><![CDATA[Double]]></dc:creator><pubDate> Tue, 12 Sep 2023 23:16:40 GMT</pubDate> </item><item><title><![CDATA[[Linkpost] Contra four-wheeled suitcases, sort of]]></title><description><![CDATA[Published on September 12, 2023 8:36 PM GMT<br/><br/><p>是简单、坚固、可靠的系统更好，还是花哨、精密、复杂的系统更好？</p><p>这篇文章带着先入之见，分析了手提箱、汽车、登山装备、食物、杯子、太空笔、人、初创公司、足球、耳机、重量、火箭、火箭、轮船和银行，并得出结论：</p><blockquote><p>我希望这个练习能够表明，简单、坚固、可靠的系统在系统上比花哨的脆弱系统更好。但事实并非如此。有时崎岖不平会获胜，有时却不会。</p></blockquote><p>它更多地说明了他发现的趋势和模式。请阅读短文以了解更多信息。</p><p>我喜欢它<a href="https://www.lesswrong.com/s/zpCiuR4T343j9WkcK">注意到混乱</a>并<a href="https://www.lesswrong.com/tag/babble-and-prune">喋喋不休地提出</a>许多有趣的类别。</p><br/><br/> <a href="https://www.lesswrong.com/posts/nFGMvs9WSeau8ATTY/linkpost-contra-four-wheeled-suitcases-sort-of#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/nFGMvs9WSeau8ATTY/linkpost-contra-four-wheeled-suitcases-sort-of<guid ispermalink="false"> nFGMvs9WSeau8ATTY</guid><dc:creator><![CDATA[Gunnar_Zarncke]]></dc:creator><pubDate> Tue, 12 Sep 2023 20:36:03 GMT</pubDate></item><item><title><![CDATA[Seeking Feedback on My Mechanistic Interpretability Research Agenda]]></title><description><![CDATA[Published on September 12, 2023 6:45 PM GMT<br/><br/><h1>为什么发这个帖子</h1><p>我全职从事 MI 研究大约三个月了，由于我目前的资助即将结束，而且我最近收到了 Lightspeed 拒绝，现在似乎是从对象级工作中抽出一些时间来反思方向的好时机以及后续步骤。我花了几个小时写了一份草稿，意识到我认为它太复杂了（为了听起来很复杂？），然后用大约 750 个字重写了我真正想做的事情以及为什么。我打算将反馈纳入 OpenPhil 早期职业申请（我将在几天内提交）。我还在申请人工智能研究职位，如果我获得了职位，这将有助于了解要关注的内容。</p><h1>议程</h1><p>在我看来，机械可解释性研究的目标是充分了解最先进的网络正在做什么，这样我们就可以检查是否正在发生任何危险行为。我<a href="https://www.neelnanda.io/mechanistic-interpretability/attribution-patching">预计</a>自动化技术将成为理解此类模型<a href="https://arxiv.org/pdf/2211.00593.pdf">的重要一步（示例：1、2、3</a> <a href="https://arxiv.org/pdf/2304.14997.pdf">）</a> 。然而，我觉得我们缺少一个重要的基础，因为我们还没有完全理解小语言模型正在做什么，因此，不知道自动化技术应该检测的一组事情。 （这些技术应该寻找推理吗？、特定行为？、记忆信息？、叠加？）。我认为，我们首先需要对浅层语言模型进行细致的、底层的探索，以指导我们对更大模型的分析。</p><p>随着<a href="https://arxiv.org/abs/2305.07759">TinyStories 模型</a>的发布，我们现在有了可以生成合理文本补全（儿童故事）的小型语言模型。 <a href="https://d.docs.live.net/5217bc84fed48838/Desktop/TinyStories-1Layer-21M">TinyStories-1Layer-21M</a>是该系列中的一个单层模型，它将作为我研究的重点。我将使用<a href="https://www.anthropic.com/index/a-mathematical-framework-for-transformer-circuits">Anthropic 的电路框架</a>对此模型进行低级机械解释。我相信，鉴于其相对较小的规模和通过网络的路径数量有限，使用电路分析该网络是可行的。</p><p>我坚信，这一层模型中将存在一些规则和模式，这些规则和模式将作为我们在更大模型中搜索事物的指南。 （当然，几乎可以肯定，在更多样化的数据集上训练的大型模型中存在该模型中不存在的规则和模式，但这应该作为建立对语言模型正在做什么的机械理解的良好起点） 。我的希望是，通过对单层模型的权重和激活进行重点低级探索，我可以构建一个人类可解释的知识和功能库，该单层模型似乎已经学会了这些知识和功能。</p><p>我已经开始探索这个模型，所以我对可能存在的组件有一些粗略的想法，但这些说法应该被理解为初步的：我相信我已经检测到似乎与某个概念相关的 MLP 神经元，例如，我发现了几个神经元，当故事中的人物“寻找”或“搜索”某物时，这些神经元似乎表现出强烈的积极性；此外，这些神经元对残差流的贡献通常支持也与“查看”或“搜索”有关的输出标记。</p><p>另一方面，一些神经元似乎支持语法规则。一个神经元对代词呈强阳性；它对残差流的贡献通常支持动词和副词输出标记。 （我 ->; 是，他们 ->; 看，他们 ->; 看到，他们 ->; 两者[感觉]）。另一个对文章非常积极；它对残差流的贡献通常支持形容词和名词（A ->; 香蕉，the->; 树，a->; 大[香蕉]）。该模型是否故意编写内容和语法规则，以便使用正确的语法成功地编写有关“搜索”的故事？是否还正在制定其他类型的规则？</p><p>一旦我拥有了知识和功能库，我将尝试手工制作可以实现此行为的网络权重，类似于<a href="https://distill.pub/2020/circuits/curve-circuits/">Chris Olah 创建的曲线检测器</a>和<a href="https://docs.google.com/document/d/1Hk1NQSQE3ycaDRULxB-Cy78FuqFW9sUDIEc_56UMlMI/edit">我过去为 1 层变压器手工制作权重的工作</a>。手工设计网络权重使我能够检测到我之前错过的网络整体机制的一部分。我预计手工权重同样会指出我对<a href="https://d.docs.live.net/5217bc84fed48838/Desktop/TinyStories-1Layer-21M">TinyStories-1Layer-21M</a>的整体解释中不完整或缺失的部分。</p><p>在过去的三个月里，我成功地解释了三个小型变压器模型（ <a href="https://www.lesswrong.com/posts/vGCWzxP8ccAfqsrS3/thoughts-about-the-mechanistic-interpretability-challenge-2">Stephen Casper 的 MI 变压器挑战</a>、 <a href="https://github.com/freestylerick/quick_MI">ARENA 每月问题#1</a> 、 <a href="https://github.com/freestylerick/First-Unique-Token">ARENA 每月问题#2</a> ）。我对使用 Pytorch 进行电路式分析来操纵和组合网络权重和激活的能力充满信心，最终创建带注释的图表，我可以检查这些图表以生成和测试假设。</p><p>了解 1 层模型的工作原理将作为了解 2 层模型的基础。对于 2 层（或更多）层的模型，我们具有注意力头组合，这可能会解锁 1 层模型无法实现的行为。通过了解 1 层模型中存在的内容，2 层模型很可能会表现出一些相同的模式和一些不同的模式。在探索 2 层模型之后，我们希望可以继续扩展，再次使用较小的模型作为我们可能期望在较大模型中找到的一些内容的指南。希望这个过程最终能让我们更好地理解大型语言模型正在做什么，以便我们能够更好地评估安全问题。</p><h1>结论</h1><p>感谢您抽出时间来阅读。再次强调，我愿意接受所有反馈，包括负面反馈。</p><p>如果您是资助者或雇主，可能有兴趣讨论和/或资助这项工作，请通过 LessWrong DM 联系。</p><p>如果您对可能资助这项研究的组织有任何想法，请随时私信或在评论中发帖。</p><br/><br/> <a href="https://www.lesswrong.com/posts/ESaTDKcvGdDPT57RW/seeking-feedback-on-my-mechanistic-interpretability-research#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/ESaTDKcvGdDPT57RW/seeking-feedback-on-my-mechanistic-interpretability-research<guid ispermalink="false"> ESaTDKcvGdDPT57RW</guid><dc:creator><![CDATA[RGRGRG]]></dc:creator><pubDate> Tue, 12 Sep 2023 18:45:08 GMT</pubDate> </item><item><title><![CDATA[Automatically finding feature vectors in the OV circuits of Transformers without using probing]]></title><description><![CDATA[Published on September 12, 2023 5:38 PM GMT<br/><br/><p>假设您正在努力了解给定的大型语言模型如何计算特定任务的输出。您可能对以下问题感到好奇：</p><ul><li>哪些线性特征向量决定模型在给定任务上的性能？</li><li>给定一组不同的任务，相同的特征在多大程度上负责模型在这些不同任务上的输出？</li><li> LayerNorm 等非线性如何转换用于给定任务的特征？</li><li>给定一对特征，如果一个输入的一个特征的值很高，那么这是否意味着该输入的另一个特征的值可能很高？</li><li>如何找到一个转向向量来添加到模型的激活中，从而增加模型在一项任务上的输出，同时减少另一项任务上的输出？</li></ul><p>最近，我一直致力于开发一种通用方法来部分回答这些问题。值得注意的是，与查找特征向量的探测方法不同，该方法可以通过<i>零前向传递数据</i>找到这些问题的近似答案，从而用很少的附加数据点<span class="footnote-reference" role="doc-noteref" id="fnrefu4fd3ietm2f"><sup><a href="#fnu4fd3ietm2f">[1]</a></sup></span>产生改进的答案。这篇文章介绍了这种寻找特征向量的方法，称为“可观察传播”；提出有关可观察传播产生的特征向量分析的理论结果；并介绍了测试该方法的一些初步实验的结果。</p><p>请注意，这一切都在进行中！我目前正在进行更多的实验，以便更好地了解可观察传播的效用和局限性。此外，我仍然必须在公开之前清理我的代码（尽管此处描述的方法应该不难重新实现）。但我认为，与其等到一切都完成后再分享我所取得的成果，不如向社区展示我迄今为止已完成的工作。</p><p>这项工作的贡献如下：</p><ul><li>这项工作引入了“可观察量”的概念，它概括了通过查看 Logit 差异来考虑模型在任务上的性能的模式。一旦人们开始将可观察量视为适合研究的具体对象，就会出现许多分析 Transformer 的新技术。</li><li>这项工作提出了一种称为“可观测传播”的方法，该方法允许人们在 Transformer 的 OV 电路中找到与任何给定可观测相对应的特征向量。请注意，此方法可以找到特征方向以及近似的特征大小，<i>而不需要任何额外的数据</i>。该方法可以使用少量数据扩展到 Transformer 中的非线性组件，以获得更好的特征量值近似值。</li><li>这项工作开发了一种特征向量分析理论。这包括一个定理，即 LayerNorm 非线性不会影响高维空间中的特征方向（尽管它们确实会影响特征大小）。这项工作还引入了一种称为“耦合系数”的相似性度量，它在输入与另一个特征向量的点积等于 1 的情况下测量输入和特征向量之间的预期点积。</li><li>我将可观察传播应用于<a href="https://cmathw.itch.io/identifying-a-preliminary-circuit-for-predicting-gendered-pronouns-in-gpt-2-smal">Chris Mathwin 等人考虑的性别代词预测问题。</a>作为案例研究。我通过考虑宾语和主语代词预测的情况来扩展他们的问题设置，并证明在这两种情况下都使用了许多相同的特征。我还发现，查看与不同注意力头相关的特征向量的范数可以很好地初步预测哪些注意力头最终对输出贡献最大。我表明，可观察传播找到的一些特征向量与它们各自注意力头的奇异向量没有完全对齐，这表明可观察传播可以找到 SVD 可能错过的特征向量。</li><li>最后，我展示了使用这些特征向量作为激活引导向量的一些初步结果，以减少模型显示的性别偏见。</li></ul><p><i>认知状态：我非常有信心可观察的传播，连同LayerNorms和耦合系数的理论，准确地描述了非MLP Transformer的OV电路，并且可以对这些OV电路的行为做出准确的预测。我也有一些信心，特征向量范数可以用来对对任务很重要的注意力头做出像样的“有根据的猜测”，尽管我必须对更多任务进行更多实验，以便变得更加确定。其他。然而，我仍然不确定理解 QK 行为对于理解 Transformer 的必要程度。我还在确定这些方法可以在多大程度上应用于 MLP。关于这里介绍的实验：代词预测任务的工作比性别偏见任务的工作更加成熟，目前更多地处于探索阶段。</i></p><h1>长话短说</h1><p>如果我们有一个任务想要评估我们的模型 - 例如，标记 A 和标记 B 之间的 logit 差异 - 那么我们可以构建与该任务相对应的线性函数。 （例如，令牌 A 和令牌 B 之间的 logit 差异对应于线性函数<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n^T = (e_{A} - e_{B})^T"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.241em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">A</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">B</span></span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span></span> <style>.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-surd + .mjx-box {display: inline-flex}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor; overflow: visible}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-test.mjx-test-display {display: table!important}
.mjx-test.mjx-test-inline {display: inline!important; margin-right: -1px}
.mjx-test.mjx-test-default {display: block!important; clear: both}
.mjx-ex-box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.mjx-test-inline .mjx-left-box {display: inline-block; width: 0; float: left}
.mjx-test-inline .mjx-right-box {display: inline-block; width: 0; float: right}
.mjx-test-display .mjx-right-box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MJXc-TeX-unknown-R {font-family: monospace; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: monospace; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: monospace; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: monospace; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
.MJXc-TeX-vec-R {font-family: MJXc-TeX-vec-R,MJXc-TeX-vec-Rw}
.MJXc-TeX-vec-B {font-family: MJXc-TeX-vec-B,MJXc-TeX-vec-Bx,MJXc-TeX-vec-Bw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-R; src: local('MathJax_Vector'), local('MathJax_Vector-Regular')}
@font-face {font-family: MJXc-TeX-vec-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-vec-B; src: local('MathJax_Vector Bold'), local('MathJax_Vector-Bold')}
@font-face {font-family: MJXc-TeX-vec-Bx; src: local('MathJax_Vector'); font-weight: bold}
@font-face {font-family: MJXc-TeX-vec-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/eot/MathJax_Vector-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/woff/MathJax_Vector-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/fonts/HTML-CSS/TeX/otf/MathJax_Vector-Bold.otf') format('opentype')}
</style>，其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="e_{A}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.241em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">A</span></span></span></span></span></span></span></span></span></span></span>是独热向量，在对应于标记 A 的位置上有 1。）受量子力学概念的<i>启发</i>，我将 logits 上的线性泛函称为可观测量 。</p><p>一旦我们有了一个可观察的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n^T"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span></span> ，然后给定一个注意力头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span> ，与可观察的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n^T"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span></span>相对应的该注意力头的特征向量由<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\left(W^{OV}_h\right)^T n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.593em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.593em; padding-bottom: 0.593em;">)</span></span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.89em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>给出，其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W^{OV}_h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span></span></span></span>是 OV 矩阵注意头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span> 。这可以简单地通过乘以它们的 OV 矩阵来扩展到虚拟注意力头，并且可以通过采用它们的线性近似来扩展到处理非线性。我证明，在高维度中，LayerNorm 不会改变特征向量方向——尽管 LayerNorm 确实会影响特征向量大小。我将这种在给定可观察量的情况下查找特征向量的通用方法称为“可观察传播”。</p><p>在可观察的传播产生特征向量后，我们可以分析它们，而无需在任何数据上运行模型。例如，我们可以查看特征向量范数来初步预测哪些注意力头可能很重要。我们还可以通过查看两个不同可观测值的余弦相似度来比较它们的特征向量；这使我们能够了解不同任务的两个电路何时使用相同的功能。我还将特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="v_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>到特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="v_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span>的</span></span></span></span></span></span>“耦合系数”定义为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\frac{v_1 \cdot v_2}{\Vert v_1 \Vert^2}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.84em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.602em; top: -1.368em;"><span class="mjx-mrow" style=""><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; vertical-align: -0.267em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; vertical-align: -0.267em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span> <span class="mjx-denominator" style="font-size: 70.7%; width: 2.602em; bottom: -1.089em;"><span class="mjx-mrow" style=""><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; vertical-align: -0.267em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span> <span class="mjx-sup" style="font-size: 83.3%; vertical-align: 0.347em; padding-left: 0px; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.84em;" class="mjx-line"></span></span><span style="height: 1.737em; vertical-align: -0.77em;" class="mjx-vsize"></span></span></span></span></span></span></span> ，并证明这表示在<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot v_1 = 1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>的情况下正态分布的嵌入向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span>和特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="v_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>之间的预期点积。</p><p>我进行了一些初步实验，将可观察传播应用于性别代词预测的设置。初步结果表明，特征向量范数通常与主动注意力头相对应；主语代词预测和宾语代词预测使用相同的特征向量；并且可观察传播产生的特征向量可以用作激活引导向量来成功改变模型的输出。</p><h1>简介：满足可观察量</h1><p>当我们想要了解模型如何执行某项任务时，通常会查看与该任务相对应的“logit 差异”。例如，当<a href="https://www.lesswrong.com/posts/cgqh99SHsCv3jJYDS/we-found-an-neuron-in-gpt-2">Joseph Miller 和 Clement Neo</a>研究导致模型预测标记“an”而不是“a”时，他们针对“an”和“a”的模型预测逻辑之间的差异执行激活修补。同样，在性别代词预测中， <a href="https://cmathw.itch.io/identifying-a-preliminary-circuit-for-predicting-gendered-pronouns-in-gpt-2-smal">Chris Mathwin 等人。</a>考虑“他”和“她”之间的逻辑差异。采用 logit 差异被认为是可解释性工作流程的重要组成部分：Neel Nanda 将其解释为<a href="https://dynalist.io/d/n2ZWtnoYHrU1s4vnFSAQ519J#z=5Z-8RDn4JFf7wLtKosyDTNXA">“一个非常好的指标，可以通过各种受可解释性启发的干预措施和技术（例如直接 logit 归因或激活修补）来判断模型性能”</a> 。</p><p>但我们在这里的第一个见解是不仅仅将逻辑差异视为实验过程中的一个步骤。相反，我们希望将它们视为可以进行数学研究和操作的具体对象。什么样的物体？好吧，如果我们取 token <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="a"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></span></span>和 token <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="b"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span></span></span>之间的 logit 差值，那么我们真正要做的就是计算<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="(e_a - e_b)^T v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span> ，</span></span></span></span></span>其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span></span></span></span></span>是 logits 向量， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="e_x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span></span></span>是带有 a 的 one-hot 向量一个位于位置<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span> 。对象<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="(e_a - e_b)^T"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span></span>是<i>线性函数</i>：从向量空间到实数的线性映射。显然，所有 Logit 差异都是 Logit 的线性函数。事实证明，除了两个标记之间的简单对数差异之外，我们可能还需要考虑线性函数。例如，我们可以考虑使用线性函数<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="(e_{\text{&quot; she&quot;}} + e_{\text{&quot; her&quot;}} - e_{\text{&quot; he&quot;}} - e_{\text{&quot; him&quot;}})^T"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; she&quot;</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; her&quot;</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; he&quot;</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; his&quot;</span></span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span></span>来表示一般预测女性性别代词的任务。</p><p>受此启发，我们有以下定义：<strong>可观察量</strong>是 logits <span class="footnote-reference" role="doc-noteref" id="fnrefq6jwzi5ovy"><sup><a href="#fnq6jwzi5ovy">[2]</a></sup></span> <span class="footnote-reference" role="doc-noteref" id="fnreflpxvw4f8bc"><sup><a href="#fnlpxvw4f8bc">[3]</a></sup></span>上的线性函数。这个想法是，我们可能关心评估的一大类任务可以形式化为 logits 上的线性函数。一旦我们这样做了，我们就可以应用线性代数工具来找到与可观察量相对应的特征向量。</p><h1>通过可观察传播寻找特征向量</h1><p>现在，我将介绍一个查找与可观察量相对应的特征向量的过程。我将这种方法称为“可观察传播”，因为它涉及通过网络向后传播可观察数据。在本节中，我们将从更简单的情况下了解可观察的传播开始，然后逐渐增强通用性。</p><h2>基本线性模型</h2><p>可观察传播背后的基本见解非常简单。假设我们有一个线性模型：对于某个矩阵<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span></span></span></span></span> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f(x) = Wx"><span class="mjx-mrow" aria-hidden="true">， <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span> 。给定一个可观察量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span> ，我们想要找到与该可观察量相对应的一些特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span></span></span> 。这意味着我们想要找到<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span></span></span>使得<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y \cdot x = n \cdot f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> 。现在观察： <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x) = n^T Wx = (W^T n)^T x = (W^T n) \cdot x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span> 。因此， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y=W^T n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span> 。通过一行简单的线性代数，我们精确地找到了<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>对应的特征向量。</p><p>请注意，这也适用于仿射情况，其中对于某些<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="b"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span></span></span> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f(x) = Wx + b"><span class="mjx-mrow" aria-hidden="true">， <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">b</span></span></span></span></span></span></span> 。在这种情况下，对于标量常数<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="c"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span></span></span> ，我们有<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x) = (y \cdot x) + c"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">c</span></span></span></span></span></span></span> ——但这仍然意味着<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span></span></span>是嵌入空间中“直接确定”输出<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span></span></span>的方向<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">×</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> 。</p><h3>旁白：可观察传播和相关方法之间的差异</h3><p>这个结果非常干净，但据我所知，还没有其他人使用过它。这让我非常惊讶！不过，其他一些作品也触及了类似的想法，我发现值得考虑我的表述与他们的表述有何不同。</p><p>在<a href="https://www.lesswrong.com/posts/cgqh99SHsCv3jJYDS/we-found-an-neuron-in-gpt-2">“我们在 GPT-2 中发现一个神经元”</a>中，Joseph Miller 和 Clement Neo 试图在 GPT-2 中找到负责预测某些标记的神经元（特别关注标记“an”）。他们在某种程度上是通过获取令牌嵌入与每个神经元输出权重（即权重矩阵的每一列）的点积并查看点积最高的神经元来实现这一点的。如果我们将此过程的结果存储在向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span></span></span>中，则我们有<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y = W^T n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>是一个 one-hot 向量，在我们关心的标记位置上有一个 1， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span></span></span></span></span>是输出权重矩阵。然而，作者并没有在概念上进行飞跃，将<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span></span></span>视为特征向量，而不仅仅是点积列表。相反，作者似乎在这样的范式下进行操作：目标是解释神经元或神经元组，而不是更一般的特征向量。这种方法可以取得一些成功，但它没有考虑到非基对齐特征，或更复杂的概念，例如<a href="https://transformer-circuits.pub/2022/toy_model/index.html">叠加</a>。</p><p>在<a href="https://www.lesswrong.com/posts/mkbGjzxD8d8XqKHzA/the-singular-value-decompositions-of-transformer-weight">“Transformer 权重矩阵的奇异值分解是高度可解释的”</a>中，Beren Millridge 和 Sid Black 表明，当使用模型的非嵌入矩阵投影到标记空间时，Transformer 权重矩阵的奇异向量会产生可解释的标记集。然后，他们演示了您可以通过首先找到这些标记的嵌入，然后查看标记嵌入和奇异向量之间的余弦相似度来找到与特定标记相对应的奇异向量；然后，具有最高余弦相似度的奇异向量被认为最有可能对应于给定的标记。但请注意，他们的工作主要是从一组奇异向量中选择与给定标记最相关的向量，即使没有一个奇异向量与该标记很好地对齐。因此，他们的框架与“我们在 GPT-2 中发现一个神经元”中相同：他们不考虑一般特征向量，而是首先考虑一组特征向量，然后从该组中选择最重要的特征向量。与给定的“查询”相关。此外，他们的工作只关注与标记相对应的奇异向量，而不是与更一般的可观察量相对应的向量。</p><p>因此，在我看来，“可观察传播”方法有两个概括，而这在上面两篇作品中没有得到：</p><ul><li>我们关心的特征向量可能无法在一小组基本向量（例如神经元或奇异向量）中找到。</li><li>我们希望不仅仅寻找与特定标记相关的特征向量，而是考虑与更一般任务相关的特征向量。 （在“可观察传播”公式中，这些“更一般的任务”对应于 logits 上的线性泛函。）</li></ul><p>我相信，在您将等式<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot Wx = (W^T n) \cdot x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span>视为对可解释性有意义的东西之前，必须先内化这些概括。当然，这提出了以下问题：我现在缺少什么概括？我们稍后再回到这个问题。</p><p>此外，虽然上述研究工作是我发现与可观察传播方法最相关的工作，但我总是有可能错过文献综述中的一篇文章或帖子。如果是这样，请告诉我。</p><h2>解释 OV 电路</h2><h3>单注意力头</h3><p>如果我们正在考虑的模型是线性的，那么我们现在有一种从任何可观察到任何特征向量的方法。不幸的是，即使是仅注意 Transformer 也是非线性的。首先，计算注意力分数的过程涉及对多个标记进行双线性运算，然后进行 softmax。然后，将每个标记的线性函数乘以这些注意力分数。</p><p>然而，这个问题可以通过仅查看<a href="https://transformer-circuits.pub/2021/framework/index.html">原始变压器电路公式中</a>所谓的“OV 电路”的关注来缓解。这个想法是，注意力可以分解为两个“电路”：确定从哪些标记读取信息的计算，以及从这些标记写入哪些信息的计算。前一种计算称为“QK电路”，后一种计算称为“OV电路”。现在，如果我们将注意力分数视为固定常数，那么我们所做的就是忽略非线性 QK 电路，而只关注 OV 电路——这是所有标记的仿射函数。事实上，回想一下 Transformer 中的注意力层可以分解为</p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="\begin{equation} x_j^{l+1} = x_j^l + \sum_{\text{attention head $h$}} \sum_{\text{token index $i$}} \operatorname{score}_h(x_i^l, x_j^l) W^{OV}_{l,h} x_i^l \end{equation}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span> <span class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op" style="padding-left: 1.8em;"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.74em; padding-bottom: 0.74em;">Σ</span></span></span></span></span> <span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">注意力头</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span></span></span></span></span> <span class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op" style="padding-left: 1.266em;"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.74em; padding-bottom: 0.74em;">Σ</span></span></span></span></span> <span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">标记索引</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span></span></span></span></span> <span class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">得分</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span><span class="mjx-mo"><span class="mjx-char"></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span></span></span></span><p>其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_j^l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span></span></span></span></span>是令牌<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="j"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span></span>在层<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span></span></span></span></span> 、 <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\operatorname{score}_{l,h}(x_i^l, x_j^l)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">分数</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">、</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span></span></span></span></span>的残差流<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\operatorname{score}_{l,h}(x_i^l, x_j^l)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>是与标记<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_i^l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_j^l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-stack" style="vertical-align: -0.311em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span></span></span></span></span>的注意力头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span>相关的第<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span></span></span></span></span>层的注意力得分，<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W^{OV}_{l,h}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span></span></span></span></span></span>是注意力头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span>的组合输出值权重矩阵在<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span></span></span></span></span>层。因此，给定一个可观察的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span> ，我们可以得到<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">第 l</span></span></span></span></span></span></span>层注意力头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span>的特征向量由下式给出</p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="y_{l,h} = (W^{OV}_{l,h} W_U)^T n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.084em;">U</span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span><p>其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W^{OV}_{l,h}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">，</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span></span></span></span></span></span>是第<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span></span></span></span></span>层注意力头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span>的组合输出值权重矩阵， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W_U"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.084em;">U</span></span></span></span></span></span></span></span></span>是令牌非嵌入矩阵。请注意，这适用于任何层的注意力头，因为每层的所有注意力头的贡献都会保留在 Transformer 的残差流中（即使这些贡献后来被覆盖，它们仍然会在第一层中输出到残差流中）地方）。</p><h3>虚拟注意力头</h3><p>此时的下一步是注意一个注意力头的输出可以用作另一个注意力头的输入。结果在变压器电路公式中被称为“虚拟注意力头”。寻找虚拟注意力头的特征向量很简单：分别给定层 l <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h, h'"><span class="mjx-mrow" aria-hidden="true">、 <span class="mjx-msup MJXc-space1"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.298em;">&#39;</span></span></span></span>处的注意力头<span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">、</span></span></span></span></span></span></span> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l, l'"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">&#39;</span></span> <span class="mjx-msup MJXc-space1"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">，</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.298em;">且</span></span></span></span></span></span></span></span></span><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l < l'"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&lt;</span></span> <span class="mjx-msup MJXc-space3"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.298em;">&#39;</span></span></span></span></span></span></span></span></span> ，即与层<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span></span></span></span></span>的头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span>相关的特征向量，<i>通过</i><i>层 l 的</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l'"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">头</span></span></span></span></span></span></span></span></span><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="h'"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.298em;">&#39;</span></span></span></span></span></span></span></span></span>介导<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="l'"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msup"><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.298em;">′</span></span></span></span></span></span></span></span></span> ，由下式给出</p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="y_{l,h} = (W^{OV}_{l,h} W^{OV}_{l',h'} W_U)^T n."><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.335em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.375em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-msup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">l</span></span></span> <span class="mjx-sup" style="font-size: 83.3%; vertical-align: 0.347em; padding-left: 0px; padding-right: 0.06em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.298em;">&#39;</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-msup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">h</span></span></span> <span class="mjx-sup" style="font-size: 83.3%; vertical-align: 0.347em; padding-left: 0px; padding-right: 0.06em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.298em;">&#39;</span></span></span></span></span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.084em;">U</span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.372em;">。</span></span></span></span></span></span></span><p>当然，这适用于任意长度的注意力头组合——只需将所有相关头的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W^{OV}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">O</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">V</span></span></span></span></span></span></span></span></span></span></span>矩阵相乘即可​​。</p><p>查看虚拟注意力头是解释 Transformer 计算的非常重要的一步：如果您只查看注意力头对输出 logits 的直接贡献，那么您最终会丢失对于理解幕后实际发生的情况至关重要的信息。我们稍后将讨论一种情况，其中模型最初似乎使用非常不同的特征向量来计算对应于两个不同可观察量的输出 - 但当我们查看虚拟注意头时，我们发现这些模型实际上使用相同的特征向量特征。</p><h3>可以忽略QK电路吗？</h3><p>回想一下，所有这些分析都只关注 OV 电路；它根本不考虑通过更改从中读取信息的标记来影响模型的所有特征方向。因此，我们应该问自己：这合理吗？当它们不考虑注意力计算的组成部分时，我们可以在多大程度上说这些特征向量捕获了模型的行为？</p><p>正如我们稍后在讨论实验结果时会看到的那样，即使可观察的传播确实因此产生了模型的不完整描述，它仍然拥有一些真正的实用性：它对与给定任务相关的注意力头提供了良好的零样本预测，它为我们提供了可用于改变模型行为的零样本转向向量，它使我们能够很好地理解一个注意头的输出与另一个注意头的输出相关的程度。我的看法是，OV 电路确实在我们感兴趣的许多任务（例如本文讨论的任务）中解释了模型的大量行为，并且至少对于这些任务，可观察传播可以是一个非常好的选择。理解模型行为的方法。</p><h2>处理非线性</h2><p>唉!现实世界中使用的变形金刚不仅仅是注意力。 Transformer 中每标记非线性的两种类型是 LayerNorm 和 MLP。我们处理它们的解决方案很简单：只需使用它们的梯度进行线性近似即可。更具体地说，如果我们有一些非线性函数<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f : \mathbb{R}^d \to \mathbb{R}^d"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">:</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">R</span></span></span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">R</span></span></span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span></span></span></span> ，那么对于给定的可观察值<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span> ，我们在<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span></span></span>处将<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="g(x) = n \cdot f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>近似为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x_0) + (x-x_0) \cdot \nabla g (x_0)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">∇</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> 。我们可以看到，<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>近似等于<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\nabla g (x_0) \cdot x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">∇</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span>加上一些加性常数。因此，与可观察的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 的</span></span></span></span></span></span></span><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span></span></span>相关联的特征向量是<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="g(x_0)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.003em;">g</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> 。</p><p>当然，必须注意选择一个好的点<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span></span></span>来近似<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span></span></span> 。我发现明智的做法是从正在使用的数据集中获取嵌入<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_-"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span></span></span></span></span></span></span></span> ，使得<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x_-) < 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&lt;</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span> ，并嵌入嵌入<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_+"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span></span></span></span></span></span></span></span>使得<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x_+) > 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">>;</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span> 。然后，您选择<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span></span></span>作为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_-"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_+"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span></span></span></span></span></span></span></span>之间的直线上的点，使得<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x_0) = 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span> 。这个想法是，<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>决策边界处的梯度应该捕获导致<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>为正或负的非线性<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span></span></span>的更大规模行为；如果我们采用<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_-"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span></span></span></span></span></span></span></span>或<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x_+"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span></span></span></span></span></span></span></span>处的梯度，那么非线性可能已经饱和，因此，非线性的行为可能无法表明其更广泛的行为。</p><p>现在，如果我们有一个涉及非线性的计算路径（例如，一个注意力头，后面跟着一个 LayerNorm，后面跟着另一个注意力头），那么给定一个可观察的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span> ，我们可以如下计算整体特征向量。首先，计算与非线性相关的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>的特征向量；将此特征向量称为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span> 。然后，<i>将此特征向量</i>视为新的可观察量，并计算下层分量相对于“可观察量” <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span>的</span></span></span></span></span></span>特征向量。冲洗并根据需要重复<span class="footnote-reference" role="doc-noteref" id="fnrefdhiuepbiqad"><sup><a href="#fndhiuepbiqad">[4]</a></sup></span> 。</p><p>在这里，值得一提的是 Neel Nanda、Chris Olah、Catherine Olsson、Nelson Elhage 和 Tristan Hume 所做的<a href="https://www.neelnanda.io/mechanistic-interpretability/attribution-patching">“归因修补”</a> 。他们的想法是通过采用模型的线性近似来加速激活修补实验（在该实验中，将给定子层的模型的激活替换为另一个示例的激活，以确定该子层是否重要）。这样，您就可以计算线性近似，而不是每次想要修补子层的激活时重新运行完整的前向传递，这要快得多。 Nanda 关于此方法的帖子还提供了一些关于线性近似何时应该表现良好（以及何时应该表现不佳）的良好直觉，当我们想要将线性近似与可观察传播一起使用时，这是相关的。</p><h2>处理 LayerNorm</h2><p>鉴于 Transformer 中的每个子层前面都有一个 LayerNorm，LayerNorm 是一个需要解决的特别重要的非线性问题。因此，我们明智的做法是对 LayerNorm 对线性近似的适用性进行更彻底的研究，以及是否可以完全规避这种近似。</p><p>在“归因修补”帖子中，Nanda 提供了一些关于 LayerNorm 梯度的直觉。他认为，对于足够小的感兴趣区域，LayerNorm 可以被视为线性。论据是这样的：LayerNorm 中的主要非线性是向量归一化步骤（即<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="v \mapsto \frac{v}{\Vert v \Vert}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">↦</span></span> <span class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.191em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.685em; top: -1.16em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span> <span class="mjx-denominator" style="font-size: 70.7%; width: 1.685em; bottom: -0.999em;"><span class="mjx-mrow" style=""><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.191em;" class="mjx-line"></span></span><span style="height: 1.527em; vertical-align: -0.707em;" class="mjx-vsize"></span></span></span></span></span></span></span> ）；在高维空间中，微小的变化<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\Delta v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">Δ</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span></span></span></span></span>将具有与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span></span></span></span></span>不正交的可忽略不计的分量；当<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\Delta v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">Δ</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span></span></span></span></span>与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span></span></span></span></span>正交时，向量归一化近似线性；因此，对于较小的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\Delta v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">Δ</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">v</span></span></span></span></span></span></span> ，LayerNorm 近似线性。</p><p>我们可以基于这种直觉来给出关于 LayerNorms 如何影响特征向量的精确论证。特别地，我们有以下定理：</p><p><strong>定理 1</strong> ：<i>定义</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f(x; n) = n \cdot \operatorname{LayerNorm}(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.519em;">;</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">LayerNorm</span></span><span class="mjx-mo"><span class="mjx-char"></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">×</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> <i>。定义</i></p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="\theta(x;n) = \arccos\left(\frac{n \cdot \nabla_x f(x; n)}{\Vert n \Vert \Vert \nabla_x f(x; n) \Vert}\right)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.519em;">;</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">arccos</span></span><span class="mjx-mo"><span class="mjx-char"></span></span> <span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.551em; padding-bottom: 1.551em;">(</span></span> <span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 7.017em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 7.017em; top: -1.59em;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">∇</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.519em;">;</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span> <span class="mjx-denominator" style="width: 7.017em; bottom: -1.09em;"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">∇</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.519em;">;</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 7.017em;" class="mjx-line"></span></span><span style="height: 2.68em; vertical-align: -1.09em;" class="mjx-vsize"></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.551em; padding-bottom: 1.551em;">）</span></span></span></span></span></span></span></span><p> <i>-- 也就是说，</i> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\theta(x;n)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.519em;">;</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>是<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span><i>和</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\nabla_x f(x; n)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">∇</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.519em;">;</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span><i>之间的角度</i><i>。那么如果</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span><i>和</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>是<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\mathbb{R}^d"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">R</span></span></span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span></span></span></span><i>中的</i><i>iid</i> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\mathcal{N}(0,I)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-cal-R" style="padding-top: 0.519em; padding-bottom: 0.372em; padding-right: 0.159em;">N</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.064em;">I</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> <i>，且</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="d\ge8"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≥</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">8</span></span></span></span></span></span></span><i>则</i></p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="\mathbb{E}\left[ \theta(x;n) \right] < 2 \arccos\left(\sqrt{1-\frac{1}{d-1}}\right)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">E</span></span></span></span> <span class="mjx-mrow MJXc-space1"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.519em;">;</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&lt;</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">反余弦</span></span><span class="mjx-mo"><span class="mjx-char"></span></span><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.551em; padding-bottom: 1.551em;">(</span></span> <span class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.551em; padding-bottom: 1.551em;">√</span></span> <span class="mjx-box" style="padding-top: 0.323em; border-top: 1px solid;"><span class="mjx-mrow"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 2.445em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.445em; top: -1.368em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span> <span class="mjx-denominator" style="width: 2.445em; bottom: -0.866em;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 2.445em;" class="mjx-line"></span></span><span style="height: 2.234em; vertical-align: -0.866em;" class="mjx-vsize"></span></span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.551em; padding-bottom: 1.551em;">）</span></span></span></span></span></span></span></span><p>可以在<a href="https://github.com/jacobdunefsky/observable-propagation/raw/master/Observable_Propagation_Proofs.pdf">此 PDF 文件</a>中找到证明。</p><p>该定理意味着在高维度中，LayerNorm 不会改变特征向量的方向。例如，如果我们有一个特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>作为注意头的输入，并且<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>是对应于直接在该注意头之前的 LayerNorm 输入的特征向量，那么<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>之间的余弦相似度将几乎为 1。这意味着如果您只关心特征向量的方向，那么您可以完全忽略 LayerNorms！</p><p>另一方面，我们也关心特征向量的大小。在这种情况下，我们希望能够快速近似 LayerNorms 的梯度。事实证明，这样做的原则方法是计算<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\frac{\sqrt{d}}{\widetilde{\Vert x \Vert}} W"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.253em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.772em; top: -1.766em;"><span class="mjx-msqrt" style=""><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.519em; padding-bottom: 0.519em;">√</span></span> <span class="mjx-box" style="padding-top: 0.111em; border-top: 1px solid;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span></span> <span class="mjx-denominator" style="font-size: 70.7%; width: 1.772em; bottom: -1.248em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.189em; padding-bottom: 0.06em; padding-left: 0.064em;"><span class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 0.519em; padding-bottom: 0.225em;">∼</span></span></span> <span class="mjx-op"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.253em;" class="mjx-line"></span></span><span style="height: 2.132em; vertical-align: -0.883em;" class="mjx-vsize"></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span></span></span></span></span> ，其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="d"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span></span>是模型维度， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span></span></span></span></span>是与 LayerNorm 相关的缩放矩阵，并且<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\widetilde{\Vert x \Vert}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.189em; padding-bottom: 0.06em; padding-left: 0.064em;"><span class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 0.519em; padding-bottom: 0.225em;">∼</span></span></span> <span class="mjx-op"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span></span></span></span></span></span></span>是 LayerNorm <span class="footnote-reference" role="doc-noteref" id="fnref5o6rzjjq02e"><sup><a href="#fn5o6rzjjq02e">[5]</a></sup></span>输入的估计。请注意， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\widetilde{\Vert x \Vert}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.189em; padding-bottom: 0.06em; padding-left: 0.064em;"><span class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 0.519em; padding-bottom: 0.225em;">〜</span></span></span> <span class="mjx-op"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span></span></span></span></span></span></span>取决于您正在考虑的输入的分布，因此，适用于某些输入的 LayerNorm 近似可能不适用于其他输入。</p><h1>无数据特征向量分析</h1><p>一旦您使用可观察传播来查找您感兴趣的特征向量，您就可以分析这些特征向量<i>，而无需运行任何前向传播</i>。在本节中，我将介绍两种有用的方法：查看特征向量范数和查看“耦合系数”。</p><h2>特征规范调查</h2><p>假设我们有一组模型组件（例如注意力头），并且我们希望初步了解哪些头对于给定的可观察量很重要。我们可以通过简单地采用与这些分量相关的特征向量的范数来进行初始预测；具有较高范数的特征向量应该对应于更有可能相关的组件。</p><p>其背后的基本原理：如果模型组件实现计算<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> ，并且<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span></span></span>是可观测<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span></span></span>的特征向量，则<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n \cdot f(x) = y \cdot x = \Vert y \Vert \Vert x \Vert \cos \theta"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">cos</span></span><span class="mjx-mo"><span class="mjx-char"></span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span></span></span></span></span></span> ，其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\theta"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span></span></span></span></span></span>是<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span>之间的角度。这意味着该模型组件的输出与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\Vert y \Vert"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span>成正比。因此，在对输入一无所知的情况下，我们可以预期<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\Vert y \Vert"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span>的值较高，意味着<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f(x)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>的值较高。</p><p>但是有关输入分布的知识改变了方程（字面意思）。特别是，我们必须对涉及 LayerNorm 梯度的特征向量进行轻微的修正。特别是，如果我们查看 LayerNorm 输入的特征向量，那么如上所述，特征向量可以写为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2 = \frac{\sqrt{d}}{\widetilde{\Vert x \Vert}} W y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.253em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.772em; top: -1.766em;"><span class="mjx-msqrt" style=""><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.519em; padding-bottom: 0.519em;">√</span></span> <span class="mjx-box" style="padding-top: 0.111em; border-top: 1px solid;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span></span> <span class="mjx-denominator" style="font-size: 70.7%; width: 1.772em; bottom: -1.248em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.189em; padding-bottom: 0.06em; padding-left: 0.064em;"><span class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 0.519em; padding-bottom: 0.225em;">∼</span></span></span> <span class="mjx-op"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.253em;" class="mjx-line"></span></span><span style="height: 2.132em; vertical-align: -0.883em;" class="mjx-vsize"></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span> ，其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>是紧随 LayerNorm 之后的任何组件的特征向量。现在，我们有那个</p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="\begin{align*} y_2 \cdot x &amp;= \Vert x \Vert \frac{\sqrt{d}}{\widetilde{\Vert x \Vert}} W \Vert y_1 \Vert \cos \theta \\ &amp;\approx \sqrt{d} W \Vert y_1 \Vert \cos \theta \\ &amp;\propto \sqrt{d} W \Vert y_1 \Vert \end{align*}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mtable" style="vertical-align: -2.721em; padding: 0px 0.167em;"><span class="mjx-table"><span class="mjx-mtr" style="height: 3.139em;"><span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: right; width: 2.173em;"><span class="mjx-mrow" style="margin-top: 0.65em;"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">×</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span><span class="mjx-strut"></span></span></span> <span class="mjx-mtd" style="padding: 0px 0px 0px 0px; text-align: left; width: 9.985em;"><span class="mjx-mrow"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.772em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 1.772em; top: -1.65em;"><span class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.519em; padding-bottom: 0.519em;">√</span></span> <span class="mjx-box" style="padding-top: 0.111em; border-top: 1px solid;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span></span> <span class="mjx-denominator" style="width: 1.772em; bottom: -1.339em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.189em; padding-bottom: 0.06em; padding-left: 0.064em;"><span class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 0.519em; padding-bottom: 0.225em;">～</span></span></span> <span class="mjx-op"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.772em;" class="mjx-line"></span></span><span style="height: 2.989em; vertical-align: -1.339em;" class="mjx-vsize"></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">余弦</span></span><span class="mjx-mo"><span class="mjx-char"></span></span><span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span><span class="mjx-strut"></span></span></span></span> <span class="mjx-mtr" style="height: 1.477em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.098em;"><span class="mjx-strut"></span></span></span> <span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.098em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.298em;">≈</span></span> <span class="mjx-msqrt MJXc-space3"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.519em; padding-bottom: 0.519em;">√</span></span> <span class="mjx-box" style="padding-top: 0.063em; border-top: 1px solid;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">cos</span></span><span class="mjx-mo"><span class="mjx-char"></span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span><span class="mjx-strut"></span></span></span></span> <span class="mjx-mtr" style="height: 1.327em;"><span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: right;"><span class="mjx-mrow" style="margin-top: -0.098em;"><span class="mjx-strut"></span></span></span> <span class="mjx-mtd" style="padding: 0.15em 0px 0px 0px; text-align: left;"><span class="mjx-mrow" style="margin-top: -0.098em;"><span class="mjx-mi"></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">∝</span></span> <span class="mjx-msqrt MJXc-space3"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.519em; padding-bottom: 0.519em;">√</span></span> <span class="mjx-box" style="padding-top: 0.063em; border-top: 1px solid;"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span></span></span></span><p>因此，如果您的特征向量涉及任何 LayerNorm 梯度，则在查看特征向量的范数时，应忽略与您正在考虑的计算路径中最早的 LayerNorm 相对应的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\widetilde{\Vert x \Vert}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-munderover"><span class="mjx-stack"><span class="mjx-over" style="height: 0.189em; padding-bottom: 0.06em; padding-left: 0.064em;"><span class="mjx-mo" style="vertical-align: top;"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 0.519em; padding-bottom: 0.225em;">∼</span></span></span> <span class="mjx-op"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span></span></span></span></span></span></span></span></span></span>项。</p><h2>耦合系数</h2><p>用于比较特征向量的常见相似性度量是余弦相似性：两个向量指向同一方向的程度。但是我们引入了另一个相似性度量，它回答了与模型输出的更具体预测相关的问题。</p><p>假设同一模型组件有两个特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span> ，对应于不同的可观察量。现在，如果输入与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>具有高点积，那么这是否意味着输入与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>具有高点积？回答这个问题可以很好地衡量一个可观察量的输出与另一个可观察量的输出“耦合”的程度。</p><p>激发了这个问题的动机，让我们将其翻译成特征向量的语言。如果<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>是函数<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="f"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span></span></span></span></span></span>的具有特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>的可观测量，则对于输入<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span> ，我们有<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_1 \cdot f(x) = y_1 \cdot x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_2 \cdot f(x) = y_2 \cdot x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.519em; padding-right: 0.06em;">f</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">×</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">。</span></span></span></span></span></span></span>现在，如果我们将输入<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span>约束为范数<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="s"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">s</span></span></span></span></span></span></span> ，并约束<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot y_1 = k"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span></span> ，那么<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>的期望值是多少？ <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>的最大/最小值是多少？我提出以下定理来回答这两个问题：</p><p><strong>定理2</strong> ：<i>令</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1, y_2 \in \mathbb{R}^d"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">∈</span></span> <span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">R</span></span></span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.003em;">d</span></span></span></span></span></span></span></span></span> <i>。令</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span></span></span></span></span></span><i>均匀分布在由约束</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\Vert x \Vert = s"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">s</span></span></span></span></span></span></span><i>和</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot y_1 = k"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span></span></span></span></span>定义的超球面上<i>。然后我们有</i></p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="\mathbb{E}[x \cdot y_2] = k \frac{y_1 \cdot y_2}{\Vert y_1^2 \Vert}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-ams-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">E</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">[</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">]</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span> <span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.68em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.68em; top: -1.237em;"><span class="mjx-mrow"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span> <span class="mjx-denominator" style="width: 2.68em; bottom: -1.233em;"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.082em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 2.68em;" class="mjx-line"></span></span><span style="height: 2.47em; vertical-align: -1.233em;" class="mjx-vsize"></span></span></span></span></span></span></span><p> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span><i>的最大值和最小值</i><i>由下式给出</i></p><span><span class="mjpage mjpage__block"><span class="mjx-chtml MJXc-display" style="text-align: center;"><span class="mjx-math" aria-label="\frac{\Vert y_2 \Vert}{\Vert y_1 \Vert} \left(k\cos(\theta) \pm \sin(\theta)\sqrt{s^2 \Vert y_1 \Vert^2-k^2} \right)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.079em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 2.079em; top: -1.59em;"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span> <span class="mjx-denominator" style="width: 2.079em; bottom: -1.09em;"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 2.079em;" class="mjx-line"></span></span><span style="height: 2.68em; vertical-align: -1.09em;" class="mjx-vsize"></span></span> <span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span> <span class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">余弦</span></span><span class="mjx-mo"><span class="mjx-char"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">±</span></span> <span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">正弦</span></span><span class="mjx-mo"><span class="mjx-char"></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.961em; padding-bottom: 0.961em;">√</span></span> <span class="mjx-box" style="padding-top: 0.251em; border-top: 1px solid;"><span class="mjx-mrow"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">s</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.256em; padding-bottom: 1.256em;">)</span></span></span></span></span></span></span></span><p><i>其中</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="\theta"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">θ</span></span></span></span></span></span></span>是<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span><i>和</i><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span><i>之间的角度</i><i>。</i></p><p>这个定理的证明可以在<a href="https://github.com/jacobdunefsky/observable-propagation/raw/master/Observable_Propagation_Proofs.pdf">之前的 PDF 文件</a>中找到。</p><p>该定理的第二部分表明，两个特征向量之间的角度很重要：角度越大， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>的可能值的范围就越大。这为使用余弦相似度来测量特征向量“耦合”提供了良好的动机。但是定理第一部分中的项<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="k \frac{y_1 \cdot y_2}{\Vert y_1^2 \Vert}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">k</span></span> <span class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.679em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.375em; top: -1.367em;"><span class="mjx-mrow" style=""><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; vertical-align: -0.267em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; vertical-align: -0.267em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span> <span class="mjx-denominator" style="font-size: 70.7%; width: 2.375em; bottom: -1.323em;"><span class="mjx-mrow" style=""><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-stack" style="vertical-align: -0.402em;"><span class="mjx-sup" style="font-size: 83.3%; padding-bottom: 0.216em; padding-left: 0.069em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.679em;" class="mjx-line"></span></span><span style="height: 1.902em; vertical-align: -0.935em;" class="mjx-vsize"></span></span></span></span></span></span></span> ，也很重要，因为它告诉您<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="x \cdot y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">x</span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span>的期望值。</p><p>受此启发，我们定义<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="C(y_1,y_2) = \frac{y_1 \cdot y_2}{\Vert y_1^2 \Vert}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.077em; padding-bottom: 0.298em;">=</span></span> <span class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.679em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.375em; top: -1.367em;"><span class="mjx-mrow" style=""><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; vertical-align: -0.267em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.004em; padding-bottom: 0.298em;">⋅</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; vertical-align: -0.267em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span> <span class="mjx-denominator" style="font-size: 70.7%; width: 2.375em; bottom: -1.323em;"><span class="mjx-mrow" style=""><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-stack" style="vertical-align: -0.402em;"><span class="mjx-sup" style="font-size: 83.3%; padding-bottom: 0.216em; padding-left: 0.069em; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span> <span class="mjx-sub" style="font-size: 83.3%; padding-right: 0.06em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">∥</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.296em; width: 1.679em;" class="mjx-line"></span></span><span style="height: 1.902em; vertical-align: -0.935em;" class="mjx-vsize"></span></span></span></span></span></span></span>为“ <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>到<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2 的</span></span></span></span></span></span></span></span></span><strong>耦合系数</strong>”。 <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="C(y_1, y_2)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>的直观解释是，平均而言，与特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">相关</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">联</span></span></span></span></span></span></span></span></span>的可观察量 n 2 的输出应该是与特征相关联的可观察量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>的输出的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="C(y_1,y_2)"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span> <span class="mjx-msubsup MJXc-space1"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span>倍向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="y_1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.006em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.519em; padding-right: 0.006em;">y</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span> 。</p><p>稍后我们将看到如何使用耦合系数来帮助找到引导向量，以减少初步实验中性别偏见的模型输出。</p><h1>实验</h1><p>为了开始测试可观察传播，我进行了一些初步实验，旨在建立关于可观察传播效用的一些直觉。</p><p>我特别考虑了两个“案例研究”。前者涉及<a href="https://cmathw.itch.io/identifying-a-preliminary-circuit-for-predicting-gendered-pronouns-in-gpt-2-smal">Mathwin 等人先前解决的性别代词预测任务。</a> 。后者考虑职业性别偏见（即预测女性姓名比男性姓名更有可能或不太可能参与某些职业的模型）。</p><p>现在，我们将继续研究这两个案例研究中的一些有趣结果。那些希望看到更多结果的人应该放心，我目前正在进行更多实验（包括更深入地考虑此处讨论的案例研究的实验，以及解决其他案例研究的实验），并期待更新帖子这些实验的结果。</p><h2>该模型</h2><p>所有这些实验中使用的语言模型是 GPT-Neo-1.3B。该模型有大约 13 亿个参数、24 层、每个注意力子层 16 个注意力头、嵌入空间维度为 2048、MLP 隐藏层维度为 8192。因此，它是一个比 GPT-2 系列更大的模型，在可解释性实验中往往更频繁地使用。使用更大的模型表明了可观察传播规模化的潜力（尽管 13 亿个参数仍然比当前最先进的模型小很多。）</p><h2>性别代词预测</h2><h3>问题设置</h3><p>该问题研究了是什么导致模型预测标记“她”而不是“他”，或“她”而不是“他”。 <a href="https://cmathw.itch.io/identifying-a-preliminary-circuit-for-predicting-gendered-pronouns-in-gpt-2-smal">马斯温等人。</a>研究了 GPT-2-small 中的主语代词情况（即预测“她”与“他”的情况）。他们分析了模型中的哪些组件负责预测这些性别代词。但通过可观察的传播，我们可以走得更远，深入了解此任务中使用的特定功能。此外，我们还考虑宾语代词的情况（即“她”与“他”）以及主语代词的情况，以便看看模型的特征是否有任何共同点。</p><p>与主语代词任务对应的可观察量是<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="(e_{\text{&quot; she&quot;}} - e_{\text{&quot; he&quot;}})"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; she&quot;</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; he&quot;</span></span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> ；我们用<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>表示这个可观察值。对应于宾语代词任务的可观察量是<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="(e_{\text{&quot; her&quot;}} - e_{\text{&quot; him&quot;}})"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; her&quot;</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot; his&quot;</span></span></span></span></span></span> <span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span></span></span> ；我们用<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>表示这个可观察量。</p><h3>提示</h3><p>遵循 Mathwin 等人的方法，我们通过采用提示模板并填写性别名称来生成提示数据集。主语代词大小写的提示模板是<code>&quot;&lt;|endoftext|>;So, [NAME] really is a great friend, isn&#39;t&quot;</code> ；然后通过将<code>[NAME]</code>替换为性别名称来生成提示。这个想法是，如果名字是女性，比如“Clara”或“Judy”，那么最有可能的下一个标记将是“she”，而如果名字是男性，比如“Mike”或“Joe”，那么最有可能的下一个标记是“she”，而如果名字是男性，比如“Mike”或“Joe”，那么最有可能的下一个标记是“she”。下一个标记可能是“他”。同样，宾语代词大小写的提示模板是<code>&quot;&lt;|endoftext|>;What do I think about [NAME]? Well, to be honest, I love&quot;</code> 。</p><p>我们的名单如下。使用的男性名字有“约翰”、“大卫”、“马克”、“保罗”、“瑞安”、“加里”、“杰克”、“阿诺德”、“乔”、“安迪”；使用的女性名字有“Jennifer”、“Jane”、“Annie”、“Chloe”、“Amy”、“Judy”、“Lisa”、“Carol”、“Clara”、“Sarah”。请注意，所有名称都是 1 个令牌长。</p><h3>特征向量范数</h3><p>我计算了<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span> observable 和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>的每个注意力头的特征向量的范数。结果如下图所示。 </p><figure class="image"><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/oi5dnlyytlqsdmzpslar" srcset="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/vpi9fn2xiettletivpkl 153w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/rp2pu9wgmtltqmgvrica 233w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/zovioyj8y7iuolbtn9aw 313w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/hlhf4ln3jwor0tjggxm2 393w"></figure><figure class="image"><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/bdvedhicucuhqn1djefl" srcset="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/hiwfstnbcvmoxf57nxfz 153w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/o0pisx0lsrje6fnkrr9s 233w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/j5mk5cvmx35vup9okvls 313w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/gwl0wgt57s849zejlsim 393w"></figure><p>当考虑 LayerNorms 时， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>具有最高特征向量范数的注意力头为 18.11、17.14、13.11 和 15.13，范数分别为 237.3204、236.2457、186.3744、145.4124。 <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>具有最高特征向量范数的注意力头为 17.14、18.11、13.11 和 15.13，范数为 159.1822、156.9978、144.9379、112.3253。这是图中最亮的四个头。</p><p>现在，我使用激活补丁来计算每个头对 logits 的贡献。我们的数据集的平均结果可以在下图中找到。 </p><figure class="image"><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/pybrmfgaz0vvax1jkqqe" srcset="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/tgpsuffyjbctsidtsehx 135w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/pb7j94skgkigtkwf5hwq 215w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/zzurcsxpwfy4kp74pe9p 295w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/pxoioopnsree4wizmbte 375w"></figure><figure class="image"><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/jduwkqywcditlxzfilnr" srcset="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/nckj0sb8hkco3ca6q59r 148w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/ntisqz0hp07upm4fzjth 228w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/epfpg1jp4tblpngfxro7 308w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/nmyfrcd1x96skngegv9a 388w"></figure><p>对<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>具有最高属性的四个注意力头是 17.14、13.11、15.13 和 13.3，损坏-干净 Logit 差异分别为 4.7859、4.5473、1.0804、0.6352。 <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>属性最高的四个注意力头分别为 17.14、15.13、13.11 和 22.2，损坏-干净的 logit 差异分别为 3.5636、3.0652、2.1328、0.5218。最引人注目的结果是，具有最大属性的三个注意力头是具有最高特征规范的四个头的子集。当然，同样引人注目的是，尽管注意力头 18.11 是具有最高特征规范的头，但它却没有出现在具有最高属性的头列表中；我怀疑这是由于 QK 电路效应造成的（即注意力头 18.11 产生的输出将对可观察量做出很大贡献 - 但它没有关注负责这些输出的令牌）。</p><p>尽管注意力头 18.11 存在“误报”，但看到特征向量规范能够正确预测真实数据上具有最高归因的四个头中的三个——<i>在不使用任何数据</i><span class="footnote-reference" role="doc-noteref" id="fnref3ckjhluza55"><sup><a href="#fn3ckjhluza55">[6]</a></sup></span>且<i>仅使用 OV 电路的情况下</i>进行预测—— - 对我来说非常令人兴奋。因此，我对使用特征向量范数的直觉是，它们可以产生一个廉价的初始“ansatz”，您应该使用更多的数据和计算密集型方法进一步研究哪些模型组件。</p><h3>余弦相似度和耦合系数</h3><p>接下来要研究的是： <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">个 subj</span></span></span></span></span></span></span></span></span></span></span>特征向量和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>特征向量之间的余弦相似度和耦合系数。余弦相似度最高的四个头部分别为 17.14、18.11、15.13 和 13.11，余弦相似度分别为 0.9882、0.9831、0.9816 和 0.9352。请注意，这些余弦相似度非常接近 1——表明该模型使用（大约）相同的特征向量来预测主语代词和预测宾语代词。当我第一次看到这些结果时，我非常兴奋：<i>我们现在有证据表明模型在两个不同的任务中使用相同的特征</i>！尽管主语代词预测和宾语代词预测确实相似，但不能保证模型会对两者使用相同的特征：因此，我对看到的情况感到惊讶。</p><p>事实上，当我们查看未嵌入前的可观测量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W_U^T n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.327em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.084em;">U</span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W_U^T n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">W</span></span></span> <span class="mjx-stack" style="vertical-align: -0.327em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.262em; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.084em;">U</span></span></span></span></span> <span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>之间的余弦相似度时，我们发现它们的余弦相似度仅为 0.5685。因此，尽管任务相似，但它们本质上并不相似，以至于模型对两者使用相同的特征是微不足道的。</p><p>然后我查看了头部 17.14、15.13 和 13.11 之间的耦合系数（在具有最高余弦相似度、最高特征规范和最高头部属性的头部中出现的共同头部）。找到它们后，下一步是记录数据集中所有嵌入与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>特征向量和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>特征向量的实际点积。完成此操作后，对于每个特征向量，我考虑<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>点积的比率，并找到适合该数据的最佳拟合线。结果如下表所示。</p><figure class="table"><table><thead><tr><th>头</th><th>耦合系数</th><th>余弦相似度</th><th>最佳拟合线斜率</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="r^2"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">r</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td> 17.14</td><td> 0.67086</td><td> 0.9882</td><td> 0.67774</td><td> 0.99811</td></tr><tr><td> 15.13</td><td> 0.77306</td><td> 0.9816</td><td> 0.79353</td><td> 0.98146</td></tr><tr><td> 13.11</td><td> 0.73552</td><td> 0.9352</td><td> 0.75580</td><td> 0.9274281</td></tr></tbody></table></figure><p>请注意，耦合系数几乎与最佳拟合线的斜率完全匹配 - 表明它们确实准确地预测了点积的比率。</p><p>除了查看两个向量之间的点积比率之外，我们还研究了耦合系数是否预测了头部之间激活修补归因得分的比率。得到的散点图如下所示：每个点代表一个注意力头，其 x 坐标表示其耦合系数，y 坐标表示该头对<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>的平均归因得分与该头的平均注意力得分之间的比率前往<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">主题</span></span></span></span></span></span></span></span></span></span></span>。 （请注意，我排除了归因分数小于 0.1 的注意力头。） </p><p><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/jheoyn9fln2i7yueuh7b" srcset="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/duyy26u39pgbavnvwy9x 96w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/i97b9e8ovkeocug0rry9 176w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/vyc9skbor4bjq79dudir 256w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/pku6jcohddfbftt0jp6c 336w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/bvyd2npiyqzjvwfszopb 416w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/fixnrhpnp994cg3glstd 496w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/jDfjqu2qJLcPco9cf/hyqgczdckk3kqusqfosv 576w"></p><p>由于 QK 电路效应，这里不存在完美的相关性，这与使用耦合系数来预测点积时不同。尽管如此，我们可以看到耦合系数仍然提供了一个不错的估计，不仅可以估计特征向量的点积的耦合程度，甚至还可以估计注意力头的<i>属性</i>的耦合程度。</p><h3>奇异值分解</h3><p>我有兴趣确定的一件事是：通过可观察传播获得的特征向量在多大程度上与权重矩阵的奇异向量对齐？我针对上面考虑的三个注意力<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="W_{OV}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.104em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.104em;">头</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.229em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em;">的</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.186em;">WOV</span></span></span></span></span></span></span></span></span></span></span>矩阵进行了研究：17.14、15.13 和 13.11。下表提供了每个头部与该头部的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>特征向量具有最高余弦相似度的奇异向量的索引以及余弦相似度。</p><figure class="table"><table><thead><tr><th>头</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">主体</span></span></span></span></span></span></span></span></span></span></span>vs <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></th><th>前 5 个奇异向量索引</th><th>前 5 个绝对余弦相似度</th></tr></thead><tbody><tr><td>17.14</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">主语</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> 1, 3, 0, 2, 4</td><td> 0.8169、0.4725、0.2932、0.0981、0.0827</td></tr><tr><td> 17.14</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></td><td>1, 3, 0, 4, 15</td><td> 0.8052、0.4980、0.2758、0.1019、0.0394</td></tr><tr><td> 15.13</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">主语</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> 0、1、17、28、13</td><td> 0.9466、0.1254、0.0875、0.0774、0.0747</td></tr><tr><td> 15.13</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></td><td>0、1、9、65、13</td><td> 0.9451、0.1761、0.0761、0.0622、0.0597</td></tr><tr><td> 13.11</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">主语</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> 4, 3, 2, 1, 7</td><td> 0.6470、0.5843、0.3451、0.2164、0.1508</td></tr><tr><td> 13.11</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></td><td>3, 4, 2, 7, 8</td><td> 0.5982、0.5345、0.4869、0.1499、0.1007</td></tr></tbody></table></figure><p>对于头 15.13，奇异向量 0 与可观察传播找到的特征向量非常一致。然而，头 17.14 的情况较少（其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>的顶部绝对余弦相似度分别为 0.8169 和 0.8052），头 13.11 的情况更小（其中<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>的顶部绝对余弦相似度）分别为 0.6470 和 0.5982）。此外，特别是对于头 17.14 和 13.11，除了最相似的向量之外，奇异向量的绝对余弦相似度仍然不可忽略，这表明单独一个奇异向量无法捕获特征向量的完整行为。</p><p>还值得注意的是，对于头 13.11， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>的最相似奇异向量不同于<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>的最相似奇异向量。由于相似向量是正交的，这意味着通过查看<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>最相似的奇异向量来天真地分析头 13.11 会错误地表明这两个可观察量对应于不同的特征（尽管它们的特征向量余弦相似度为 0.9352）。</p><p>我认为这些例子展示了<a href="https://www.lesswrong.com/posts/mkbGjzxD8d8XqKHzA/">Beren Millridge 和 Sid Black</a>探索的使用 SVD 解释权重矩阵的实用性，而且还展示了使用可观察传播构建显式特征向量的必要性，而不是仅查看最相似的奇异向量。事实证明，SVD 作为可解释性的第一步很有用，但它并不能说明全部情况。可观察传播的显式特征向量允许进行进一步的定量分析。</p><h3>激活转向</h3><p>如前所述，可观测传播没有考虑变压器 QK 电路中涉及的非线性。因此，有人担心可观察传播产生的特征向量无法准确预测模型在实践中的行为。</p><p>为了测试这种恐惧，我进行了一些初步的激活引导实验：看看是否可以将可观察传播发现的特征向量添加到某些标记的嵌入中来改变模型的输出。这个想法是，如果这些向量表示即使在存在 QK 电路的情况下也具有鲁棒性的特征，那么添加这些向量应该会导致模型的输出相应地改变（例如，将<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>的特征向量添加到嵌入应该会导致更高的输出）对于<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">主题</span></span></span></span></span></span></span></span></span></span></span>）。</p><p>我在三个感兴趣的注意力头（17.14、15.13、13.11）上测试了<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>可观察量的激活控制。首先，我使用<a href="https://dynalist.io/d/n2ZWtnoYHrU1s4vnFSAQ519J#z=disz2gTx-jooAcR0a5r8e7LZ">logit 归因</a>来确定哪个标记对于每个头来说最重要。然后，我将该注意力头的特征向量加/减 50 倍到该标记的嵌入<span class="footnote-reference" role="doc-noteref" id="fnrefyjcwq2rp51i"><sup><a href="#fnyjcwq2rp51i">[7]</a></sup></span> 。我查看了提示数据集模型输出的平均差异；结果如下表所示。</p><figure class="table"><table><thead><tr><th>头</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">主体</span></span></span></span></span></span></span></span></span></span></span>vs <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></th><th>代币</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="-50v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">50</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">V</span></span></span></span></span></span></span>平均差</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="+50v"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">50</span></span> <span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">V</span></span></span></span></span></span></span>平均差</th></tr></thead><tbody><tr><td>17.14</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">主语</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> 15</td><td> -100.780</td><td> 87.517</td></tr><tr><td> 17.14</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></td><td>15</td><td> -87.038</td><td> 70.865</td></tr><tr><td> 15.13</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">主语</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> 6</td><td> -13.238</td><td> 26.132</td></tr><tr><td> 15.13</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></td><td>6</td><td> -22.681</td><td> 23.150</td></tr><tr><td> 13.11</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">主语</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> 6</td><td> -4.111</td><td> 12.659</td></tr><tr><td> 13.11</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">对象</span></span></span></span></span></span></span></span></span></span></span></td><td>6</td><td> -16.343</td><td> 5.992</td></tr></tbody></table></figure><p>正如我们所看到的，特征向量非常有效——尽管在某些注意力头中比其他注意力头更有效。除了不同强度的效果之外，我们还看到不对称性，其中减去特征向量比添加该特征向量产生更大的效果，反之亦然。我将这些现象归因于 QK 电路非线性以及注意力头合成效应（例如，头 13.11 的特征向量实际上可能与虚拟注意力头 13.3 ->; 17.14 的特征向量方向相反——其中相同的转向向量不仅影响同一层中的不同头，甚至影响稍后计算中的不同头）。尽管如此，激活控制在这种情况下是有效的，这一事实让我对可观察到的传播充满了希望。</p><h2>初步性别偏见结果</h2><p>除了性别代词预测的工作之外，我还想研究一个更“实际”的问题：解决语言模型中的职业性别偏见。考虑提示模板<code>&quot;&lt;|endoftext|>;My friend [NAME] is an excellent&quot;</code> ，其中<code>[NAME]</code>被替换为性别名称。现在，如果提示中的名字是女性，那么我们期望模型预测下一个标记更有可能是“女演员”而不是“演员”——这两个标记指的是相同的职业，但前者是语法上是女性，而后者在语法上通常是男性。这是语言模型中的明智行为。</p><p>然而，该模型还预测，对于女性名字，下一个标记更有可能是“护士”而不是“程序员”。在这种情况下，我们说该模型是有偏差的，因为它是根据性别进行预测的，尽管护理和编程职业之间的差异不应与语法性别相关。</p><p>因此，这引发了以下问题：</p><ul><li>导致模型预测“女演员”比“演员”更有可能的相同特征是否也会导致模型预测“护士”比“程序员”更有可能？</li><li>我们能否找到激活引导向量来减少“护士”相对于“程序员”的预测程度，同时增加“女演员”相对于“演员”的预测程度？</li></ul><p>我们可以通过定义感兴趣的可观察量来开始解决这些任务。 <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">同样</span></span></span></span></span></span></span></span></span></span></span>是可观察的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="e_{\text{&quot; actress&quot;}} - e_{\text{&quot; actor&quot;}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">“女演员”</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">-</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">“演员”</span></span></span></span></span></span></span></span></span></span></span> ，代表模型预测标记“女演员”而不是“演员”的程度。 <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>将是可观察的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="e_{\text{&quot; nurse&quot;}} - e_{\text{&quot; programmer&quot;}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">&quot;nurse&quot;</span></span></span></span></span></span> <span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">e</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">&quot;programmer&quot;</span></span></span></span></span></span></span></span></span></span></span> ，表示模型预测标记“nurse”而不是“programmer”的程度。理想情况下，对于<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">相同的</span></span></span></span></span></span></span></span></span></span></span>女性名字，模型的输出会很高，因为这代表模型认识到“女演员”这个词专门用于女性；另一方面，对于给定女性名字的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span> ，模型的输出应该较低，因为否则，这是模型偏差的证据。</p><p>尽管我仍在研究此任务，但以下是一些初步结果，展示了可观察传播在此设置中的应用。</p><h3>该模型使用一些相同的特征来预测<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">与</span></span></span></span></span></span></span></span></span></span></span><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>相同</h3><p>最初查看<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">same</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>之间注意头特征向量的余弦相似度并不表明该模型对两个可观察量使用相似的特征：对于头 15.13，发现的最高余弦相似度仅为 0.4896。 （有趣的是，我们还发现了一些余弦相似度小于-0.75的头部。）</p><p>然而，我随后考虑了注意力头部的构成，这取得了更多的成果。作为一个例子，我发现对应于虚拟注意力头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="6.6 \to 15.13 \to 17.14"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">6.6</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">15.13</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">17.14</span></span></span></span></span></span></span>的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">same</span></span></span></span></span></span></span></span></span></span></span>特征向量与对应于虚拟头<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="6.6 \to 15.13 \to 21.13"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">6.6</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">15.13</span></span> <span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span> <span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">21.13</span></span></span></span></span></span></span>的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>特征向量具有<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="0.9541"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0.9541</span></span></span></span></span></span></span>的余弦相似度。请注意，在不考虑任何注意力头组成的情况下，头 6.6 的余弦相似度为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="-0.0640"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">-</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0.0640</span></span></span></span></span></span></span> 。</p><p>我的初步结论是，当考虑到注意力头组成时，该模型在计算<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">的</span></span></span></span></span></span></span></span></span></span></span>输出时确实使用了一些与<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>相同的特征。换句话说，用于正确预测女性名字比“演员”更有可能出现在标记“女演员”之前的一些相同信息也被用来产生女性名字更有可能关联的偏见输出标记为“护士”而不是“程序员”。</p><p>在更新中，我计划对两个可观察量之间的共享特征向量进行更彻底的分析。但就目前而言，这样的结果似乎表明，在某种程度上，相同的中间计算正在用于所需的场景和有偏差的场景。</p><h3>寻找转向向量来消除模型的偏差</h3><p>然后我想看看是否可以找到一些引导向量，这样当这些向量添加到某些激活时，它们会提高模型在<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">相同</span></span></span></span></span></span></span></span></span></span></span>目标上的性能，但会降低其在<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>目标上的性能；这对应于减少偏见行为同时增加期望行为。</p><p>作为我们的引导向量，我尝试使用来自多个不同注意力头的特征向量，这些注意力头的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">相同</span></span></span></span></span></span></span></span></span></span></span>特征向量和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">不同</span></span></span></span></span></span></span></span></span></span></span>特征向量之间的耦合系数是最负的。尽管并非每个头都能工作，但我发现许多头在为这些头添加特征向量时确实产生了所需的效果。我使用之前激活引导实验的方法来评估激活引导结果，使用通过将性别名称插入提示模板<code>&quot;&lt;|endoftext|>;My friend [NAME] is an excellent&quot;</code>生成的数据集。这些头的结果可以在下表中找到：</p><figure class="table"><table><thead><tr><th>头</th><th>代币</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">不同</span></span></span></span></span></span></span></span></span></span></span>或<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n 个</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">相同</span></span></span></span></span></span></span></span></span></span></span></th><th>耦合</th><th>功能乘数</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">差异</span></span></span></span></span></span></span></span></span></span></span>效应</th><th><span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span>效果<span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">相同</span></span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td> 17.6</td><td> 5</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">差异</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> -0.5230</td><td> -300</td><td> -3.6119</td><td> 2.7614</td></tr><tr><td> 18.2</td><td> 0</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">差异</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> -0.2298</td><td> -1000</td><td> -0.4604</td><td> 0.4694</td></tr><tr><td> 19.15</td><td> 0</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">差异</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> -0.4957</td><td> -300</td><td> -0.8513</td><td> 1.8351</td></tr><tr><td> 23.10</td><td> 4</td><td> <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">相同</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">_</span></span></span></span></span></span></span></span></span></span></span></td><td> -0.5665</td><td> -120</td><td> -1.2027</td><td> 0.1038</td></tr></tbody></table></figure><p>请注意，我们使用了一些尝试和错误来找出哪些注意力头产生了最佳效果，以及哪些特征乘数最好。由于之前激活引导实验讨论中提到的原因，并不是每个注意力头都像人们最初想象的那样有效。然而，通过使用具有最大负耦合系数的磁头作为指导，我能够相对容易地找到一些好的转向矢量。</p><p>特别是，当我从标记 5 的嵌入中减去注意头 17.6 的<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>的特征向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="-300"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">-</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">300</span></span></span></span></span></span></span>倍时，这令人印象深刻地导致<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{diff}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.372em;">diff</span></span></span></span></span></span></span></span></span></span></span>的平均效果为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="-3.6119"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">-</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">3.6119</span></span></span></span></span></span></span> logits， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{same}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.151em; padding-bottom: 0.372em;">same</span></span></span></span></span></span></span></span></span></span></span>的平均效果为<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="2.7614"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2.7614</span></span></span></span></span></span></span> logits。这意味着，将该向量应用于嵌入后，<i>有偏差输出的平均预测</i><i>比之前少</i>了<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="-3.6119"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span> <span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">3.6119</span></span></span></span></span></span></span> logits，而语法正确的输出的平均预测比之前多了 2.7614 logits。</p><p>我发现这些初步的激活引导结果是可观察传播带来的好处的一个很好的例子。通过使特定任务能够在数学上形式化为可观察量，然后可以使用耦合系数等指标来比较其相应的特征向量，可以使搜索能够提高模型在一项任务上的性能同时降低模型在另一任务上的性能的引导向量变得更加简单。</p><h1>讨论</h1><p>那么，考虑到这些实验，我们可以说可观察传播有多大用处呢？到目前为止，我发现的初步结果（包括本文中介绍的结果）表明它至少在以下方面非常有用：</p><ul><li>它允许使用特征向量范数和耦合系数来预测模型组件的行为，而无需在任何数据上运行模型。即使预测与实际结果之间存在差异，预测仍然可以用作进一步分析的良好起点。</li><li>它可以提供整个模型中针对给定任务正在使用哪些信息的“痕迹”。</li><li>它让我们可以了解模型何时对多个不同的任务使用相同的特征，从而更好地理解模型使用的常见计算。</li><li>它可以用作查找与特定任务相关的激活引导向量的起点，甚至可以作为对不同任务产生不同（预期）影响的激活引导向量。</li></ul><p>当然，所提出的可观察传播仍然存在许多限制。最大的限制是可观察传播仅解决 Transformer 中的 OV 电路，忽略 QK 电路中执行的所有计算。例如，这意味着<a href="https://transformer-circuits.pub/2021/framework/index.html#induction-heads">感应头</a>背后的机制无法充分建模。这也导致了激活引导实验中出现的一些意想不到的效果（例如不对称效果、特征向量不如预期有效等）。现在，处理 QK 电路相当困难，因为与 MLP 和 LayerNorm 不同，QK 电路是涉及多个标记的非线性。但为了让我们充分理解《变形金刚》，QK电路必须得到解决：不能有任何<i>无知</i>。</p><p>除此之外，还有一个问题是，用于扩展可观察传播以与 MLP 一起使用的线性近似方法可以在多大程度上产生一组与 MLP 中不同的近线性子区域相对应的易于处理的特征（<i>如</i><a href="https://www.lesswrong.com/posts/eDicGjD9yte6FLSie">多胞形透镜</a>），或者 MLP 中的非线性是否太大以至于使这种努力不可行。一些未纳入本文的初步实验表明， <span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{subj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">subj</span></span></span></span></span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n_{\text{obj}}"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span class="mjx-texatom" style=""><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.519em;">obj</span></span></span></span></span></span></span></span></span></span></span>的 MLP 特征向量的余弦相似度约为 0.60——这并不是太高。但余弦相似度可能不是衡量通过线性近似找到的“局部特征”之间相似度的正确度量；或者，找到执行线性近似的点的更好方法可能会产生更相似的特征向量。无论如何，我计划在更大的数据集上进行更多实验，重点关注 MLP 特征。</p><p>尽管存在这些限制，我认为可观察的传播代表着深入理解 Transformer 在计算中使用的特征向量以及如何使用这些特征向量来改变这些模型的行为的重要的第一步。至少对我来说，这些初步实验的结果表明，可观察传播将被证明是解释和操纵 Transformer 的有用工具。</p><p>最后一点，让我们回到之前的问题，即什么概括可以增加可观察传播的能力，但我没有提出这个问题。当然，我很难一一列举我自己的盲点。不过，我要说的是，一个限制是“可观察/特征向量”范例仅着眼于单个标记和特征向量之间的交互，而不是多个标记之间的交互。但例如，多个令牌之间的交互对于理解 QK 电路是必要的。现在，在线性代数的设置中，多个向量上的函数的自然排序是“多线性形式”，它将线性函数的概念推广到多个参数。因此，推广可观察传播范式（目前仅使用线性泛函）的一种方法是考虑多线性形式。但这样做的正确方法还有待观察。</p><h1>结论</h1><p>在这篇文章中，我介绍了“可观察传播”，这是一种在 Transformers OV 电路中自动查找与某些任务相对应的特征向量的简单方法。这篇文章还开发了一个用于分析这些特征向量的数学框架，该框架允许在不同任务上预测模型行为，而无需在任何数据上运行模型。初步实验表明，这些方法在预测模型行为和引导模型行为达到预期结果方面表现良好。当然，在测试和改进这些方法方面还有很多工作要做，但我认为到目前为止我在这篇文章中所介绍的内容意味着可观察传播已经很有用了。</p><p>如果这篇文章激起了您的兴趣，请继续关注包含更多实验的更新。感谢您的阅读！ </p><ol class="footnotes" role="doc-endnotes"><li class="footnote-item" role="doc-endnote" id="fnu4fd3ietm2f"> <span class="footnote-back-link"><sup><strong><a href="#fnrefu4fd3ietm2f">^</a></strong></sup></span><div class="footnote-content"><p>对于那些已经阅读过的人来说：这指的是通过忽略 LayerNorm 来找到近似特征向量，并通过在这些数据点上找到 LayerNorm 的线性近似来使用少量数据找到更好的近似。</p></div></li><li class="footnote-item" role="doc-endnote" id="fnq6jwzi5ovy"> <span class="footnote-back-link"><sup><strong><a href="#fnrefq6jwzi5ovy">^</a></strong></sup></span><div class="footnote-content"><p>这个名字的目的是暗示量子力学中“可观察量”的概念。在该领域中，可观测量是厄米算子，对应于想要测量的量子系统的某些属性。尽管该设置与 LLM 设置之间存在一些差异（例如，线性泛函不是 Hermitian 算子），但这两种情况之间的相似性提供了有价值的直觉：在这两种情况下，可观察量都是对应于概率系统的测量类型。</p></div></li><li class="footnote-item" role="doc-endnote" id="fnlpxvw4f8bc"> <span class="footnote-back-link"><sup><strong><a href="#fnreflpxvw4f8bc">^</a></strong></sup></span><div class="footnote-content"><p>请注意，虽然线性函数和向量通常是不同的东西，但在有限维向量空间中，线性函数和向量之间确实存在一对一的自然对应关系。因此，对于向量<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span> ，我可能会稍微滥用符号并将<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span></span></span>和<span><span class="mjpage"><span class="mjx-chtml"><span class="mjx-math" aria-label="n^T"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span> <span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.12em;">T</span></span></span></span></span></span></span></span></span>称为可观察量。</p></div></li><li class="footnote-item" role="doc-endnote" id="fndhiuepbiqad"> <span class="footnote-back-link"><sup><strong><a href="#fnrefdhiuepbiqad">^</a></strong></sup></span><div class="footnote-content"><p>本质上，这个过程实际上所做的就是通过经过非线性的模型来计算特定计算路径的梯度。</p></div></li><li class="footnote-item" role="doc-endnote" id="fn5o6rzjjq02e"> <span class="footnote-back-link"><sup><strong><a href="#fnref5o6rzjjq02e">^</a></strong></sup></span><div class="footnote-content"><p>这是从<a href="https://raw.githubusercontent.com/jacobdunefsky/observable-propagation/master/Observable_Propagation_Proofs.pdf">定理 1 证明</a>中使用的 LayerNorms 梯度表达式得出的。</p></div></li><li class="footnote-item" role="doc-endnote" id="fn3ckjhluza55"> <span class="footnote-back-link"><sup><strong><a href="#fnref3ckjhluza55">^</a></strong></sup></span><div class="footnote-content"><p>从技术上讲，使用嵌入的平均范数来近似模型中最终 LayerNorm 的梯度<code>ln_f</code> 。但由于与这些单个注意力头相关的计算路径都经过相同的 LayerNorm，因此我们可以通过完全忽略 LayerNorm 来获得相对特征向量范数的近似值。我在这里没有包含相关数字，但是在不考虑 LayerNorm 的情况下查看特征向量规范会产生相同的前四个注意头。</p></div></li><li class="footnote-item" role="doc-endnote" id="fnyjcwq2rp51i"> <span class="footnote-back-link"><sup><strong><a href="#fnrefyjcwq2rp51i">^</a></strong></sup></span><div class="footnote-content"><p>与其他常数相反，将特征向量乘以 50 没有什么原则性。</p></div></li></ol><br/><br/> <a href="https://www.lesswrong.com/posts/jDfjqu2qJLcPco9cf/automatically-finding-feature-vectors-in-the-ov-circuits-of#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/jDfjqu2qJLcPco9cf/automatically-finding-feature-vectors-in-the-ov- Circuits-of<guid ispermalink="false"> jDfjqu2qJLcPco9cf</guid><dc:creator><![CDATA[Jacob Dunefsky]]></dc:creator><pubDate> Tue, 12 Sep 2023 17:50:12 GMT</pubDate> </item><item><title><![CDATA[Startup Roundup #1: Happy Demo Day]]></title><description><![CDATA[Published on September 12, 2023 1:20 PM GMT<br/><br/><p>最近有很多与 Y-Combinator 相关问题相关的讨论，与往常一样与他们的年度演示日相关。似乎值得将它们分成一个帖子。</p><span id="more-23535"></span><h4>拍卖中的竞标者大多认为价格太高</h4><p>YC 正在开会，所以所有平常的话题又回来了。</p><blockquote><p> Paul Graham：就像每一批 YC 项目一样，投资者抱怨估值太高，但初创公司无论如何都会筹集资金。</p><p>库什：您认为发生这种情况有什么具体原因吗？</p><p>保罗·格雷厄姆：一些投资者无法理解所有回报都集中在重大胜利这一事实的含义。不过，顶级投资者明白这一点；您很少会因为价格而失去其中之一。</p><p> Amal Dorai：YC 估值的动态范围不是比公司本身更窄吗？我们看到他们的融资幅度几乎是 2 倍，但当前牵引力的变化超过 10 倍。那些雄心勃勃的公司很好，但那些风险更大的公司仍然在 8 号球后面站稳脚跟。</p><p> Paul Graham：估值的变化远小于质量的变化。这才是决定风险的因素，而不是他们当前的吸引力。如果当前的牵引力是一个完美甚至良好的预测指标，那么投资就会变得非常容易。</p><p> David Tran：“当买家抱怨但仍然付款时，你就找到了市场价格” <img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/2azxasXxuhXvGfdW2/yskawtp1xroyjv2jhhtq" alt="😃" style="height:1em;max-height:1em"></p><p>丹·格雷：我看到投资者说的是，他们宁愿等待一年，然后投资下一轮——下一轮的价格相似，但有更多的证据。如果首轮融资未能为风险提供适当的上涨空间，那么投资者为什么要加入呢？</p><p>保罗·格雷厄姆：这是一个有趣的新颖变体。我只看到一位投资者这么说。这是一个愚蠢策略的原因是，选择一年后估值没有增加的公司就等于选择了糟糕的公司。</p></blockquote><p>这个模型告诉我，YC 中估值较低、不太令人兴奋的公司可能被高估，而 YC 中估值较高、更令人兴奋的公司则被高度低估。</p><p>我在这里看到了两种截然不同的动力，格雷厄姆和多莱加注的动力，以及特兰的动力。</p><p> Tran 是投资者抱怨价格过高的核心原因。当然，大多数投资者认为YC的价格太高了。有大量投资者追逐的 YC 公司数量并不多，但他们的融资轮次空间并不大。与非 YC 公司相比，YC 公司具有许多优势，包括所有三个：</p><ol><li>选择效应（我不认为整轮的假AI公司是零，但YC非常善于挑选优秀的创始团队和有前途的公司）。</li><li>代言效应（YC血统是一个强有力的信号和协调点，有了名字一切都会变得更容易）。</li><li>丰富效应（YC 为您提供了一个令人惊叹的网络和工具包，并教会您很多知识，并给您动力和专注力）。</li></ol><p>除此之外，还有估值压缩效应。</p><p>据互联网报道，YC 公司被明智地建议提高各轮的底价，因为这可以在所有权方面节省大量资金，而且凭借 YC 的名字，你无论如何都可以筹集到资金。因此，那些相对不那么令人兴奋的公司收取的费用很高，这是理所应当的。当你可以出售更少的股权以获得更多的钱时，为什么你要以更少的钱出售更多的股权？</p><h4>你会为收取更多费用而付出代价</h4><p><a target="_blank" rel="noreferrer noopener" href="https://twitter.com/paulg/status/1694099152404398581">Paul Graham 指出</a>，这整个动态使 YC 变得有价值，而且证人非常可信。</p><blockquote><p>未来的创始人：当后期投资者像往常一样抱怨 YC 公司在演示日的估值过高时，他们的意思是，做 YC 可以让你以更少的稀释来筹集资金。</p><p>对于 YC 来说，这是一个很有价值的主张，但如果是由那些显然无意恭维的人为 YC 提出的，那就更好了。</p></blockquote><p>从初创公司的角度来看，其增加的价值有多少来自认可而不是丰富，这并不重要。对他们来说，选择的程度确实很重要。</p><p>我还要指出的是，YC 的存在降低了每家不在 YC 中的公司的估值。你知道如果他们可以做 YC，他们很可能会做，所以你正在与高度逆向选择作斗争。那么，就更有理由去做 YC 了。</p><h4>最优惠的价格带来最优惠的价格</h4><p>YC 中最令人兴奋的公司收费也很高，但看起来他们的收费并没有高出多少。据我了解，该领域有一个关于“应该是”估值的惯例。你可以在这个范围内进行调整，但一旦创始人一开始就以异常高的估值筹集资金，价格的重要性就会大大降低，因为他们放弃的公司股份要少得多。因此，与其筹集更多资金来换取更少的公司股份，不如将重点转移到赢得盟友、开辟道路和讲述正确的故事上。</p><p>特别是，避免可能的折价融资和选择正确的战略风险投资合作伙伴的考虑似乎主导了高端市场的价格考虑。</p><p>你很少会因为价格而失去顶级风险投资家，因为双方都有强烈的愿望不让这阻止交易。初创公司获得更好的风险投资流来帮助其成功，而顶级风险投资家则获得更好的交易流，从而提供大部分阿尔法。</p><p>从这家初创公司的角度来看，这是一场史诗般的公路抢劫，利用风险投资公司的惯例以远低于其价值的价格购买股权，但考虑到目前的情况，他们最好还是付款。</p><p>如果你是顶级 VC，这真是太棒了。你不断推出优质产品，YC 将为你提供大量交易流量，在未充分利用其定价能力的绝佳机会上闪耀光芒。</p><p>如果你不是顶级的VC，这是一个大问题。现在正在发生逆向选择，不仅仅体现在后期估值的增长上。如果您可以投资 YC 上您认为不错的广泛公司组合，甚至是 YC 整体公司，那就没问题了。问题是你做不到这一点，所以你所关注的公司的前景比其他公司高出 10%（这些公司不会回复你的电子邮件，因为你很糟糕，他们可以做得更好），但估值只有 50%，并且说价格太高。</p><blockquote><p> <a target="_blank" rel="noreferrer noopener" href="https://twitter.com/Jeffreyw5000/status/1692996154235949166">Jeff Weinstein</a> ：原本在 2017 年至 2020 年筹集资金上限为 800 万美元的 YC 初创公司如今筹集资金上限为 2000 万美元。</p><p>这在一定程度上是由于 YC 投资规模更大和最惠国待遇所致，但也感觉这些公司得到了不好的建议，并且仍然否认我们已经不再是 2021 年了。</p><p>如果你的执行绝对完美，找到 PMF，并筹集足够的资金来为你提供数年的跑道，那么这很好，但通常情况下，这会让初创公司在 12 个月内陷入困境，因为它们的估值取决于市盈率而不是故事。</p><p>鉴于这些创始人在演示日前后以无法投资的价格筹集资金，我们越来越频繁地因价格而通过并在 12 个月内重新审视！</p><p> Amjad Masad（首席执行官 Replit）：这只是市场动态——创始人没有任何非理性。阿尔法只是在消散（你无权获得阿尔法）。</p><p>那些将继续产生回报的人是那些可以获得巨大所有权%的优秀挑选者以及那些在种子前（和YC前）进行投资的人。</p></blockquote><p>我在这里与马萨德唯一的争吵是，人们必须小心，不要将优秀的挑选者与良好的交易流程混淆。风投绝对没有理由有权获得阿尔法，或者大多数 YC 投资甚至应该是不错的交易。</p><p>对于初创公司来说，这种动态的结果是，大多数初创公司通过提高评价和声誉从 YC 中获得巨大价值，但最顶尖的初创公司却没有。他们已经发出了足够强烈的信号，表明他们将在融资时自己开票，而不是收取市场出清价，因此提高市场出清价起不了多大作用。</p><p>尽管存在股权成本，那些顶级公司是否应该做 YC？它不太明显，而且可能因具体情况而异，特别是因为您永远无法尽早确定自己是否是或将继续成为这些公司之一，而 YC 可以帮助您成为其中一员。如果我的人生定位是我可以做 YC 并且正在创建一家合适的公司，那么无论事情看起来有多好，如果他们答应了，我肯定会申请并打算接受。如果我放弃一点价值，我就做得很好，所以我不在乎。</p><h4>提早加薪、经常加薪、到处加薪</h4><p><a target="_blank" rel="noreferrer noopener" href="https://twitter.com/kwharrison13/status/1699457717977391608">凯尔·哈里森提供了看似不错的建议</a>，其中大部分都是标准的。从一年多的跑道开始筹集资金，因为它需要可变的时间，而且可能会很长，现在你比以往任何时候都不能指望风投来实际交付。广泛撒网并与许多风险投资家交谈，但要直接说明你是谁以及你需要什么样的合适人选，这样就不会在两端浪费时间。</p><p>他建议写一份阐明事情的备忘录，而不是纯粹依赖甲板。这看起来确实是一种优越的平衡。</p><h4>优秀的风险投资人经常会出人意料地收回资金</h4><p><a target="_blank" rel="noreferrer noopener" href="https://twitter.com/paulg/status/1694401451169308912">保罗·格雷厄姆（Paul Graham）在下一点上看到了与我不同的结论。</a></p><blockquote><p> Paul Graham：VenCap 的 David Clark 分析了 1986 年至 2018 年间由 259 只基金支持的 11,350 家初创公司的回报。这些投资中约有一半亏损，但 121 家 (1.1%) 返还了投资它们的全部基金金额。</p><p>他们的十大投资中有两家是在 2010 年之后成立的。两家都是 YC 公司。这就是 YC 吸引后期投资者的原因。估值可能很高，但这是真正优秀的初创公司所在的地方，这对于回报来说是最重要的。</p><p> David Clark：按成本倍数计算，前 10 名基金回报者如下： 10. Coinbase 9. Slack 8. Portal Software 7. Facebook 6. Avanex 5. Google 4. Ariba 3. Yahoo 2. Brocade 1. DoorDash 倍数范围为 140 倍超过 800 倍</p></blockquote><figure class="wp-block-image"><a href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6a839c18-8b2b-4ef2-95c8-9ead44a54da1_680x413.jpeg" target="_blank" rel="noreferrer noopener"><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/dGvcx3giYngcSEaMZ/pnqljhj791iv3f6ex2l1" alt="图像"></a></figure><p>相反，我看到了尤里的反应。</p><blockquote><p> Yuri Sagalov：实际上，令我惊讶的是，只有约 50% 的投资回报率低于 1 倍。我原以为这个数字会更高。</p><p>保罗·格雷厄姆：我也是。但我们还处于早期阶段。</p></blockquote><p>如果你能同时在 46.8% 的时间内收回你的钱，并且还有这种利润分配，那就是一个了不起的生意。即使您完全放弃基金回报者并将其他所有人标记为其范围的极低端，这也是 36.8% 的回报率。是的，FR 很重要，如果我们有 259 只基金进行约 12,000 笔投资，它们的平均起价约为 50 倍，但如果你只有一半的时间完全错过，你实际上并不需要它们。正如保罗指出的那样，这些将是稍后的投资，但也不会那么晚。</p><h4>如果你想把事情做好</h4><p><a target="_blank" rel="noreferrer noopener" href="https://twitter.com/gustaf/status/1692685141221531728">Gusaf Alstomer（YC 的）指出，在融资平台上使用设计师是行不通的</a>。</p><blockquote><p> Gusaf Alstomer：融资方案建议：我认为我从未见过通过使用设计师来设计筹款方案而变得更好。使用 Figma、Keynote 等精美工具也是如此</p><p><a href="http://Pitch.com" rel="nofollow">http://Pitch.com</a>或 Canva。在<a target="_blank" rel="noreferrer noopener" href="https://twitter.com/ycombinator">@ycombinator，</a>我们建议人们使用 Google 幻灯片并保持简单。创始人犯的两个错误是相信工具的创造性能力可以创造出更好的牌组。第二个错误是认为设计很重要。</p><p>最有创造力的人在约束下工作。最强大的工具就是你的言语和讲故事。清晰的沟通和相关的故事讲述可以让听众将自己置于正在解决问题的人的立场上。形象化这一点的最佳方法是使用有这些问题的真人的真实照片。</p><p>最好的筹款平台具有以下结构：</p><p> 1) 标题总结了你要表达的观点</p><p>2) 3-4 个要点，并提供支持你所阐述观点的证据</p><p>3）重复直到你涵盖所有结论</p><p>4) 将其融入讲故事的叙述中——将幻灯片与故事联系在一起</p><p>5) 只要有可能，只使用真实照片，如果使用屏幕截图，请放大讲述故事的内容</p><p>“不雇用设计师规则”的例外情况是创始人本身就是设计师。他们知道这项业务的重要之处——其他人永远不会知道这一点。</p></blockquote><p>这也非常符合我的经历。设计师拥有截然不同的技能，并且瞄准不同的目标。他们不明白什么是重要的，而重要的事情通常会很快发生变化，或者当你改变环境时，你会想要即时编辑。这套牌还需要与您保持一致并与您的声音相匹配。是的，如果你的套牌看起来不错固然很好，但最终这并不重要。</p><p>这里有一个重要的普遍观点。当主要专业知识最重要时，您经常会看到人们在次要领域犯下可怕的错误，因为获胜的策略是专注于重要的事情。我想知道人工智能是否会改变这一点。</p><h4>你需要时间来做这件事</h4><p>一个常见的生产力主题是，默认情况下，人们会做大量繁重的工作，占用他们大量的时间。另一个是，照顾好基本面并让你的房子井井有条会给你带来很大的帮助。</p><p>如果您的时间和精力很有价值，特别是如果您是创始人并且部署了效率递增回报， <a target="_blank" rel="noreferrer noopener" href="https://twitter.com/webdevMason/status/1699172098865057968">也许有人应该提供帮助？</a></p><blockquote><p> Avi：我愿意为一项完全满足我基本需求的服务支付这么多钱，这样我就可以集中精力</p><p>* 洗衣店</p><p>* 每天 3 次膳食准备</p><p>* 私人教练</p><p>* 清洁工</p><p>* 治疗师把我的房子变成了一座修道院。</p><p>这应该是VC的增值。创始人应该把自己当作运动员</p><p>梅森：别说了</p><p>别说出来</p><p>梅森不</p><p>啊啊啊啊啊这是你想要的妻子</p><p>阿维（对他的OP的明确答复，但这个顺序更合乎逻辑，也更有趣）：有趣的是，如果我在推特上说我想要一个妻子为我做这件事，我也会被批评。我觉得如果你筹集资金，其中一部分应该“暂时”用于消除干扰。这包括健康的膳食准备、睡眠跟踪等。我知道这条推文听起来有点无聊，但我是一个 20 岁的单身人士，无意建立恋爱关系。我以工作为生。 Twitter 是我唯一的恶习。</p><p> <a target="_blank" rel="noreferrer noopener" href="https://twitter.com/drethelin/status/1699288880657338382">Misha Gurevich</a> （回应OP）：我认为太多人小时候看过蝙蝠侠，并认为“修道院”是把你变成坏蛋的培训中心，而不是让你在贫困中做体力劳动和祈祷的根本无聊的地方。</p><p>很多人似乎认为，如果他们有一个管家，他就会成为蝙蝠侠的阿尔伯特，但实际上他们想要的是他们的伍斯特的吉夫斯。</p><p> “吉夫斯是一名男仆，不是管家；也就是说，他负责服务个人，而管家则负责一个家庭并管理其他仆人。在极少数情况下，他确实会代替别人的管家。据伯蒂·伍斯特说，他“可以与他们中最优秀的人较量。”</p></blockquote><h4>您需要更多的信用本质上是金钱</h4><p><a target="_blank" rel="noreferrer noopener" href="https://twitter.com/yuris/status/1693784255237968307">友情提醒</a>。</p><blockquote><p> Yuri Sagalov：创始人，如果您有幸拥有 AWS 等积分，请不要将它们视为“免费资金”。相反，请将其视为资产负债表上<strong>只能</strong>用于一个目的的额外现金，并将您的 AWS 使用情况计入您的消耗的一部分。不要等到它们用完。</p><p> James Hu：这与信用卡积分和里程的思考方式相同。它是现金，对于任何旅行的人来说都和现金一样好，并且应该被同等对待。</p></blockquote><p>确切地。如果你在某个地方有信用并且不可避免地会花掉它然后继续消费，那么该信用在功能上与现金没有什么不同。花它和花现金没有什么不同。这同样适用于任何其他可以代替现金的资产。如果它会被浪费，那就不同了，否则它的价值就等于机会成本。通常每美元接近 1 美元。</p><h4>快速推出您的应用程序</h4><blockquote><p><a target="_blank" rel="noreferrer noopener" href="https://twitter.com/theapplehub/status/1699725358017523928">Apple Hub</a> ：App Store 和 iOS 现已被正式指定为欧盟的看门人，需要遵守《数字市场法案》(DMA)，这意味着苹果将需要允许用户从互联网和第三方应用程序下载应用程序商店。</p><p>您同意这个规定吗？</p><p> Emmett Shear：哇，如果它得到执行，这真是一个大新闻。对于科技生态系统来说，这将是很长一段时间内最好的事情……如果美国不效仿，欧洲初创企业实际上将获得显着优势！或者至少是首先在欧盟部署的初创公司。</p></blockquote><p>没有进行民意调查，我猜这是 Apple Hub 的正确选择。</p><p>我不会有监管此类事务的习惯，但如果我有的话，这将是一个很好的监管选择。这看起来确实有第一级帮助。</p><p>这对初创公司有什么作用？这意味着您无需通过应用程序商店即可将您的应用程序提供给欧洲的 iPhone 用户。如果您可以在没有应用商店的情况下找到它们。如果他们愿意侧载。这将是罕见的。即使在 Android 上，人们也不喜欢侧载，因为 Android 上支持侧载，并且人们选择加入该生态系统。</p><p>我的预测是，这最终不会产生那么大的实际影响。</p><h4>不，比那更快</h4><blockquote><p>Bri Kimmel：这是很长一段时间以来的第一个 YC 演示日，大多数 B2B 公司都有付费客户、经常性收入，并且与规模太大而无法与小型初创公司合作的公司签订了大额合同。</p><p> <a target="_blank" rel="noreferrer noopener" href="https://twitter.com/garrytan/status/1699777074456924662">Garry Tan</a> （YC 总裁）：今天出席的公司中有 75% 在 YC 的第一天就没有收入。 81% 的人从未筹集过一毛钱。在过去的三个月里，我们努力推动初创公司构建有意义的软件并进行销售。这是我真正见过 YC 为创始人所做的加速。</p><p>乔·本杰明：你认为为什么这么多创始人在刚起步时迟迟没有走出去并出售产品？</p><p> Garry Tan：害怕失败。</p></blockquote><p>人们很容易忘记选择效应、网络效应和其他可供性正在发挥作用。</p><p> If you are in YC, you have been selected by Garry Tan and others based in large part on them thinking you will soon be able to go out and sell, then they are giving you lessons on how to do that, network connections and other resources to help you do that, helping sculpt your pitches and targets and such, and also giving you the &#39;I&#39;m in YC&#39; foot in the door that I presume helps with large companies. You have the tools to make sacrifices in order to do the selling, in turn in order to go faster and get better valuations and also learn faster. And of course they exert massive social pressure in the other direction.</p><p> If you are not in YC, you are in a very different situation all around. It is very possible to be attempting to sell too much too quickly, before you are ready.</p><p> Failure can also be not only damaging but cascading. Games that come out and try to get revenue too early and fail to sell are marked as failures, I have had this happen to me and watched it happen elsewhere – the game improved later, the algorithms and fans have moved on, it is too late. A focus on revenue before it is too early can also waste your time, tell the wrong story that breaks your ability to continue or raise, burn your best leads and plays before you are ready, or otherwise devastate.</p><p> So no, I do not think this decision is that easy, even if what are otherwise the best startups would be better served selling more and selling faster. I have had multiple experiences with the opposite mistake.</p><h4> All The Startups Are Now AI Startups</h4><p> <a target="_blank" rel="noreferrer noopener" href="https://twitter.com/paulg/status/1697083056597631271">Meanwhile, Paul Graham continues to notice that YC is now all about AI</a> .</p><blockquote><p> Paul Graham: I haven&#39;t been more optimistic about YC since I retired in 2014. Garry has been doing a great job, and the current batch is a particularly good one.</p><p> The AI boom will be very good for YC. It will mean a lot more startups, and the kind of founders who win at it are the kind that YC specializes in.</p><p> YC has already been transformed by the AI boom. I&#39;d guess more than half the founders in the current batch are working on AI startups. It&#39;s like an ongoing AI symposium with over 200 participants.</p></blockquote><p> I actually buy this. A YC-style team and approach are unusually well suited to this moment, YC&#39;s infrastructure will be a big help, and YC will largely have its pick of founders. What a great time to be YC.</p><p> I would once again however double down that there are doubtless quite a few bogus AI companies involved. Nothing becomes this ubiquitous, this all-consuming, this hyped, without bogosity. Failure to spot them, however, does not automatically mean <a target="_blank" rel="noreferrer noopener" href="https://www.youtube.com/watch?v=5vEp5Bv-J40&amp;ab_channel=EliteFilmClips">you are the sucker</a> . It is a hits-based system, so what if some of them aren&#39;t real? What matters is the deal flow giving you access to the best stuff, not avoiding false positives.</p><p> <a target="_blank" rel="noreferrer noopener" href="https://twitter.com/paulg/status/1699815950772519277">So, what are all these non-bogus companies up to?</a></p><blockquote><p> Aaron Levie: All the enterprise AI startups going after verticals have the right idea. Pick a market, deeply understand the workflows, build simple software to model the workflows, and use AI to augment the human judgment involved. Huge opportunity in 1,000&#39;s of categories.</p><p> Paul Graham: This is the median startup in the current YC batch.</p></blockquote><p> I have certainly seen worse plans. Enough to fill out a demo day. I would doubt that there are thousands of such categories offering great opportunity.</p><h4> Man With Moat Unconcerned With Non-Flying Creatures</h4><p> What happens if someone copies you? <a target="_blank" rel="noreferrer noopener" href="https://twitter.com/paulg/status/1697761812698034630">Don&#39;t worry about it</a> , says Paul.</p><blockquote><p> Paul Graham: When people copy you, the best strategy is usually to ignore them. People who copy you are (a) unoriginal and (b) opportunists, and those are both strong predictors of failure. If you wait them out, they&#39;ll eventually drop away.</p><p> Joel Fraunsic: “I&#39;ve been imitated so well I&#39;ve heard people copy my mistakes.” ― Jimi Hendrix</p><p> Paul Graham: This happened with both Viaweb and Y Combinator.</p></blockquote><p> When people attempt to make exact copies on various levels, yes they usually fail, but often they also don&#39;t, and if there are lots of imitators most of them failing does not mean that you can safely ignore the phenomenon. The advice to ignore them goes hand in hand with working actually super hard to ensure that one can safely ignore them, by being the best like no one ever was and continuously improving and having strong reputational and network effects. In which case, sure, bring it on.</p><p> If they are not exactly copying you, rather taking you as reason to compete, that is in a sense great news about your situation absent the competition, but it definitely should worry you, especially if the competition is well-resourced. Noticing one example…</p><blockquote><p> Danny Alberson (CEO Agentive,YC &#39;23): I recently met with a VC firm twice, showed a product demo, and answered countless questions about our strategy. Only to find out from someone else they were already invested in a direct competitor.</p><p> Paul Graham: I just sent you an email. This should go in the investor database.</p><p> Danny Alberson: Absolutely. Thanks for following up.</p><p>绝对地。 Thanks for following up.: Please consider open sourcing it!</p><p> Li Ang: An open source database is very much needed.</p><p> Ronak Shah (other reply): This happened to me too. Not only the calls but they kept asking for my financial model so they could see my pricing / how I won big logos. They hid the fact that they invested in my competitor.</p></blockquote><p> [several other replies noted similar behavior, especially related to Web3/crypto]</p><p> Garry Tan (QTing Alberson): Warning to investors: there are consequences to this kind of behavior. I will personally make sure of it.</p><p> Austen Allred: I love YC.</p><p> Ryan Peterson: YC invests in competitors constantly though.</p><p> Paul Graham: This isn&#39;t a case of investing in a competitor. It&#39;s a case of pretending to be interested in a company in order to pump it for information.</p><h4> The Investor Database Is a Killer App</h4><p> There are a lot of services you get from YC. Given how multiplicative everything is when it comes to startups, it does not take much to get a big payoff. Purely raising your ambition alone is great, many other seemingly simple principles are great.</p><p> The payoff that impresses me most is the reputation, followed by the network. The most underrated is likely the broadly construed investor database, where you get intel on all the venture capitalists.</p><p> It is vastly different dealing with people whose actions have been and will be recorded into a central database. The VC knows that you will report back. You get to use the previous reports to know which VCs will treat you well, offer which resources, use which styles of negotiations, respond well to various approaches, and so forth. If the information is accurate, the ultimate impact on ability to raise money, from the right people, under the right conditions at the best price, seems colossal.</p><p> While I understand why one would want to retain this competitive advantage, it would be wonderful if this information could be disseminated to everyone. Behavior would improve, those who treat investors well would get rewarded, and outsiders in particular would have a much better shot at being founders. Even if I&#39;m not that excited to accelerate the ability to create AI startups right now, this has to be the right thing to do.</p><p> Would it be expensive to YC to give this up? My instincts say that it would not be. It would be amazing advertising, it would fuel the ecosystem and it would demonstrate value. There are enough additional advantages to YC that I predict most founders would not change their decision whether to participate. YC is not charging a market clearing price.</p><br/><br/> <a href="https://www.lesswrong.com/posts/dGvcx3giYngcSEaMZ/startup-roundup-1-happy-demo-day#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/dGvcx3giYngcSEaMZ/startup-roundup-1-happy-demo-day<guid ispermalink="false"> dGvcx3giYngcSEaMZ</guid><dc:creator><![CDATA[Zvi]]></dc:creator><pubDate> Tue, 12 Sep 2023 13:20:07 GMT</pubDate> </item><item><title><![CDATA[Is there something fundamentally wrong with the Universe?]]></title><description><![CDATA[Published on September 12, 2023 12:02 PM GMT<br/><br/><p> <i>Edit: added a paragraph nearing the end</i><br><br> Usually the question is: &quot;What is wrong with our society?&quot;, but I guess my gripe is that if you look at things with a System-lense, usually what you focus on is what has the most influence.<br><br> In other words, if our Planet would veer off course, it isn&#39;t really the fault of the Ants - even when they could have done more! The reason is bigger gravitational forces, or our Sun wanting some more space.<br><br> So, why would you blame a human being for something that seems to be governed by laws, forces and powers we A) don&#39;t fundamentally understand, B) can&#39;t fundamentally influence C) can&#39;t fundamentally change ?<br><br> I mean, from a human perspective, there are a lot of answers - Psychology, sociology, anthropology, evolutionary disciplines, religion - even transdisciplinary groups and projects. But again, you only answer the question from <i>inside the box</i> . If the box gives a certain output, and has specific constraints, why blame the Outputs for how the box works?</p><p> It makes more sense to me to assign fault at the level where the problem lies. If we dislike and abhor something, at which level does it arise?<br> A lot of expressions we use are filled with assumptions that are focused on our personal actions. Take murder, for example. Killing is bad, I agree, but is it the personal choice of the killer to enable murder, to make possible the possibility of dying? The pain, suffering, dread etc.? It is the Universe&#39;s Laws and principles that are allowing it and actively engaging in it (There are endless ways this Universe can and will kill us), is it not?<br><br> That is just one of numerous examples I can think of where I am questioning if by looking closely at an issue, it seems to be the direct consequence of a superintended principle we have 0 direct control over.<br> I mean, personal responsibility sounds nice, but if you really look at it - does it make any sense? Take genes, for example. They are based on millions of years of biological, and then even cultural evolution. That you have the &#39;ability&#39; to see a different way than eating your fellow friend, and can see more gains in keeping them alive - is it really &quot;Your&quot; achievement? How many choices are really &quot;Yours&quot;, and not the inexplicable results of processes that started millions of years before you were even consciously aware that you had a face and a body separate from the rest of the world?<br><br> Because if the problem is the Universe, wouldn&#39;t you have to fix its underlying Laws and principles if you wanted to fundamentally change anything? Because any other change would only be superficial, partial and temporary.<br><br> To also add that here, you can of course look at humans as &#39;Part&#39; of the universe, and not separate. Different maybe, but not separate. Which is a relevant vein to delve into, if you have something. As I see it, there doesn&#39;t seem to be a reciprocally positive relationship between the Universe and our individual consciousness - which seems odd. If break-ups have taught me anything, it might seem that the Universe is still bitter we stole that god-damn apple.<br><br> On a separate note (Joke joke?)<br> And so It is that I am still looking for the Universe help-desk. If anyone knows the number, or how to contact them, please let me know. If I&#39;m a beta-tester, I believe I should let them know that some things really, really, really don&#39;t seem to work that well.<br><br> Kindly,<br> Caerulea-Lawrence</p><br/><br/> <a href="https://www.lesswrong.com/posts/GbQFbsswjDpkuSYEA/is-there-something-fundamentally-wrong-with-the-universe#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/GbQFbsswjDpkuSYEA/is-there-something-fundamentally-wrong-with-the-universe<guid ispermalink="false"> GbQFbsswjDpkuSYEA</guid><dc:creator><![CDATA[Caerulea-Lawrence]]></dc:creator><pubDate> Tue, 12 Sep 2023 12:02:44 GMT</pubDate> </item><item><title><![CDATA[Apple Cider Baklava]]></title><description><![CDATA[Published on September 12, 2023 2:10 AM GMT<br/><br/><p><span>自从去年遇到</span><a href="https://www.jefftk.com/p/apple-cider-syrup">苹果汁糖浆</a>以来，我一直在试图弄清楚用它可以做什么。苹果酒甜甜圈是传统的，但我不太喜欢。将其混合到生奶油中效果非常好，并且可以为烘焙食品提供良好的甜酸馅料或配料。我尝试过松饼，用它来混合液体、糖、调味剂和发酵用的酸，但我还没有得到任何令我满意的结果。但几天前我做了一些苹果果仁蜜饼，这是我最喜欢的！</p><p> <a href="https://www.jefftk.com/baklava-loaf-pan-mostly-gone-big.jpg"><img src="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/wu3r9AfKMDYzLzPPc/t8bligbnzszddyu1o3gf" srcset="https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/wu3r9AfKMDYzLzPPc/t8bligbnzszddyu1o3gf 550w, https://res.cloudinary.com/lesswrong-2-0/image/upload/f_auto,q_auto/v1/mirroredImages/wu3r9AfKMDYzLzPPc/fidrhkddito9amo2czvc 1100w"></a></p><div></div><p></p><p><a href="https://en.wikipedia.org/wiki/Baklava">果仁蜜饼</a>是一层层的<a href="https://en.wikipedia.org/wiki/Filo">酥皮面团</a>（一种非常薄的面团），中间被脂肪隔开，每隔几层就有坚果。烘烤后，将甜糖浆倒在上面。在美国，人们可能最熟悉希腊风格，它使用黄油作为脂肪，核桃作为坚果，蜂蜜作为糖浆，但存在大量的地区差异。</p><p>我做了两个平底锅，一个是纯素的（地球平衡），一个不是（黄油）。黄油的味道好很多；可能有比地球平衡更好的选择吗？我用杏仁作为坚果，因为这就是我所拥有的。对于糖浆，我使用了新英格兰煮沸的苹果酒。对结果非常满意，我计划再做一次！</p><p> (Each loaf pan used ~$1.80 of <a href="https://www.webstaurantstore.com/mountain-cider-company-64-fl-oz-100-natural-spiced-apple-cider-concentrate/110MTCIDER64.html">cider syrup</a> , though if you really like it you could <a href="https://www.webstaurantstore.com/mountain-cider-company-100-natural-spiced-apple-cider-70-brix-concentrate-54-gallon-drum/110MTCIDERLG.html">buy in bulk</a> and get it down to $1.42.)</p><br/><br/><a href="https://www.lesswrong.com/posts/wu3r9AfKMDYzLzPPc/apple-cider-baklava#comments">讨论</a>]]>;</description><link/> https://www.lesswrong.com/posts/wu3r9AfKMDYzLzPPc/apple-cider-baklava<guid ispermalink="false"> wu3r9AfKMDYzLzPPc</guid><dc:creator><![CDATA[jefftk]]></dc:creator><pubDate> Tue, 12 Sep 2023 02:10:05 GMT</pubDate></item></channel></rss>